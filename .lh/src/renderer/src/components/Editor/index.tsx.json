{
    "sourceFile": "src/renderer/src/components/Editor/index.tsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 251,
            "patches": [
                {
                    "date": 1665496693570,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1665496704134,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -17,9 +17,8 @@\n interface MilkdownEditor {\n   onHeadersChange: Function\n }\n export const MilkdownEditor: React.FC<MilkdownEditor> = ({ onHeadersChange }) => {\n-  const [headers, setHeaders] = useState([{}])\n   useEffect(() => {\n     console.log('headers-change')\n     onHeadersChange(headers)\n   }, [headers.length])\n"
                },
                {
                    "date": 1665496710646,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -17,12 +17,8 @@\n interface MilkdownEditor {\n   onHeadersChange: Function\n }\n export const MilkdownEditor: React.FC<MilkdownEditor> = ({ onHeadersChange }) => {\n-  useEffect(() => {\n-    console.log('headers-change')\n-    onHeadersChange(headers)\n-  }, [headers.length])\n   const { editor, getInstance } = useEditor((root) =>\n     Editor.make()\n       .config((ctx) => {\n         ctx.set(rootCtx, root),\n"
                },
                {
                    "date": 1665497543528,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -4,9 +4,9 @@\n import { ReactEditor, useEditor } from '@milkdown/react'\n // 通用markdown预设\n import { commonmark } from '@milkdown/preset-commonmark'\n import { history } from '@milkdown/plugin-history'\n-import { defaultMarkdown } from '../../constant'\n+\n import { listenerCtx, listener } from '@milkdown/plugin-listener'\n import { prism } from '@milkdown/plugin-prism'\n import { menu } from '@milkdown/plugin-menu'\n import { themeManagerCtx } from '@milkdown/core'\n"
                },
                {
                    "date": 1665497548834,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -21,9 +21,13 @@\n   const { editor, getInstance } = useEditor((root) =>\n     Editor.make()\n       .config((ctx) => {\n         ctx.set(rootCtx, root),\n-          ctx.set(defaultValueCtx, defaultMarkdown),\n+          ctx.set(defaultValueCtx, `# H1\n+          ## H2\n+          ### H3\n+          #### H4\n+          ###### H5`),\n           // // 代码的默认形式？\n           // ctx.set(defaultValueCtx,{\n           //     type:'html',\n           //     dom:document.querySelector('#pre') as HTMLElement\n"
                },
                {
                    "date": 1665500699045,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -13,21 +13,30 @@\n // 亮色主题\n import { nordLight } from '@milkdown/theme-nord'\n // 暗色主题\n import { nordDark } from '@milkdown/theme-nord'\n+// 官方引用的图标库，如菜单栏需要使用到\n+import '@material-design-icons/font'\n+// 数学公式渲染\n+import 'katex/dist/katex.min.css'\n+// 代码高亮\n+import 'prism-themes/themes/prism-material-oceanic.min.css'\n interface MilkdownEditor {\n   onHeadersChange: Function\n }\n export const MilkdownEditor: React.FC<MilkdownEditor> = ({ onHeadersChange }) => {\n   const { editor, getInstance } = useEditor((root) =>\n     Editor.make()\n       .config((ctx) => {\n         ctx.set(rootCtx, root),\n-          ctx.set(defaultValueCtx, `# H1\n+          ctx.set(\n+            defaultValueCtx,\n+            `# H1\n           ## H2\n           ### H3\n           #### H4\n-          ###### H5`),\n+          ###### H5`\n+          ),\n           // // 代码的默认形式？\n           // ctx.set(defaultValueCtx,{\n           //     type:'html',\n           //     dom:document.querySelector('#pre') as HTMLElement\n"
                },
                {
                    "date": 1665500707677,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -22,9 +22,9 @@\n import 'prism-themes/themes/prism-material-oceanic.min.css'\n interface MilkdownEditor {\n   onHeadersChange: Function\n }\n-export const MilkdownEditor: React.FC<MilkdownEditor> = ({ onHeadersChange }) => {\n+export const MilkdownEditor: React.FC<MilkdownEditor> = () => {\n   const { editor, getInstance } = useEditor((root) =>\n     Editor.make()\n       .config((ctx) => {\n         ctx.set(rootCtx, root),\n"
                },
                {
                    "date": 1665500716444,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -20,9 +20,8 @@\n import 'katex/dist/katex.min.css'\n // 代码高亮\n import 'prism-themes/themes/prism-material-oceanic.min.css'\n interface MilkdownEditor {\n-  onHeadersChange: Function\n }\n export const MilkdownEditor: React.FC<MilkdownEditor> = () => {\n   const { editor, getInstance } = useEditor((root) =>\n     Editor.make()\n"
                },
                {
                    "date": 1665503483477,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -19,23 +19,20 @@\n // 数学公式渲染\n import 'katex/dist/katex.min.css'\n // 代码高亮\n import 'prism-themes/themes/prism-material-oceanic.min.css'\n-interface MilkdownEditor {\n-}\n+interface MilkdownEditor {}\n+const DEFAULT_MARKDOWN = `# H1\n+## H2\n+### H3\n+#### H4\n+###### H5`\n export const MilkdownEditor: React.FC<MilkdownEditor> = () => {\n   const { editor, getInstance } = useEditor((root) =>\n     Editor.make()\n       .config((ctx) => {\n         ctx.set(rootCtx, root),\n-          ctx.set(\n-            defaultValueCtx,\n-            `# H1\n-          ## H2\n-          ### H3\n-          #### H4\n-          ###### H5`\n-          ),\n+          ctx.set(defaultValueCtx, DEFAULT_MARKDOWN),\n           // // 代码的默认形式？\n           // ctx.set(defaultValueCtx,{\n           //     type:'html',\n           //     dom:document.querySelector('#pre') as HTMLElement\n"
                },
                {
                    "date": 1665555339805,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -45,11 +45,16 @@\n       .use(listener)\n       .use(prism)\n       .use(menu)\n   )\n-\n   const instance = getInstance()\n   instance?.action((ctx) => {\n     ctx.get(themeManagerCtx).switch(ctx, nordDark)\n   })\n+  useEffect(() => {\n+    const handleRightClick = () => {}\n+    const editor = document.querySelector('.editor')\n+    editor?.addEventListener('contextmenu', handleRightClick)\n+    return editor?.removeEventListener('contextmenu', handleRightClick)\n+  })\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1665555348436,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -50,9 +50,11 @@\n   instance?.action((ctx) => {\n     ctx.get(themeManagerCtx).switch(ctx, nordDark)\n   })\n   useEffect(() => {\n-    const handleRightClick = () => {}\n+    const handleRightClick = () => {\n+      console.log('right-click')\n+    }\n     const editor = document.querySelector('.editor')\n     editor?.addEventListener('contextmenu', handleRightClick)\n     return editor?.removeEventListener('contextmenu', handleRightClick)\n   })\n"
                },
                {
                    "date": 1665589054134,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -25,8 +25,9 @@\n ## H2\n ### H3\n #### H4\n ###### H5`\n+window.api.onUpdateEditor\n export const MilkdownEditor: React.FC<MilkdownEditor> = () => {\n   const { editor, getInstance } = useEditor((root) =>\n     Editor.make()\n       .config((ctx) => {\n"
                },
                {
                    "date": 1665590638679,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -25,9 +25,11 @@\n ## H2\n ### H3\n #### H4\n ###### H5`\n-window.api.onUpdateEditor\n+window.api.onUpdateEditor((e: any,value: any)=>{\n+  console.log(value)\n+})\n export const MilkdownEditor: React.FC<MilkdownEditor> = () => {\n   const { editor, getInstance } = useEditor((root) =>\n     Editor.make()\n       .config((ctx) => {\n"
                },
                {
                    "date": 1665591176549,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -25,9 +25,10 @@\n ## H2\n ### H3\n #### H4\n ###### H5`\n-window.api.onUpdateEditor((e: any,value: any)=>{\n+window.api.onUpdateEditor((e,value)=>{\n+  console.log(e)\n   console.log(value)\n })\n export const MilkdownEditor: React.FC<MilkdownEditor> = () => {\n   const { editor, getInstance } = useEditor((root) =>\n"
                },
                {
                    "date": 1665632240457,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,6 +1,6 @@\n import React, { useEffect, useState } from 'react'\n-import { defaultValueCtx, Editor, rootCtx } from '@milkdown/core'\n+import { defaultValueCtx, Editor, editorViewCtx, rootCtx, serializerCtx } from '@milkdown/core'\n import { nord } from '@milkdown/theme-nord'\n import { ReactEditor, useEditor } from '@milkdown/react'\n // 通用markdown预设\n import { commonmark } from '@milkdown/preset-commonmark'\n@@ -29,20 +29,17 @@\n window.api.onUpdateEditor((e,value)=>{\n   console.log(e)\n   console.log(value)\n })\n+\n+\n export const MilkdownEditor: React.FC<MilkdownEditor> = () => {\n   const { editor, getInstance } = useEditor((root) =>\n     Editor.make()\n       .config((ctx) => {\n         ctx.set(rootCtx, root),\n           ctx.set(defaultValueCtx, DEFAULT_MARKDOWN),\n-          // // 代码的默认形式？\n-          // ctx.set(defaultValueCtx,{\n-          //     type:'html',\n-          //     dom:document.querySelector('#pre') as HTMLElement\n-          //   })\n-          ctx.get(listenerCtx).markdownUpdated((ctx, markdown, prevMarkdown) => {})\n+\n       })\n       .use(nord)\n       .use(commonmark)\n       .use(history)\n@@ -53,8 +50,12 @@\n   const instance = getInstance()\n   instance?.action((ctx) => {\n     ctx.get(themeManagerCtx).switch(ctx, nordDark)\n   })\n+  instance?.config(ctx =>{\n+    ctx.get(listenerCtx).markdownUpdated((ctx, markdown, prevMarkdown) => {})\n+\n+  })\n   useEffect(() => {\n     const handleRightClick = () => {\n       console.log('right-click')\n     }\n"
                },
                {
                    "date": 1665632248101,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -51,9 +51,11 @@\n   instance?.action((ctx) => {\n     ctx.get(themeManagerCtx).switch(ctx, nordDark)\n   })\n   instance?.config(ctx =>{\n-    ctx.get(listenerCtx).markdownUpdated((ctx, markdown, prevMarkdown) => {})\n+    ctx.get(listenerCtx).markdownUpdated((ctx, markdown, prevMarkdown) => {\n+      console.log(markdown)\n+    })\n \n   })\n   useEffect(() => {\n     const handleRightClick = () => {\n"
                },
                {
                    "date": 1665632267993,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -36,9 +36,9 @@\n   const { editor, getInstance } = useEditor((root) =>\n     Editor.make()\n       .config((ctx) => {\n         ctx.set(rootCtx, root),\n-          ctx.set(defaultValueCtx, DEFAULT_MARKDOWN),\n+          ctx.set(defaultValueCtx, DEFAULT_MARKDOWN)\n \n       })\n       .use(nord)\n       .use(commonmark)\n"
                },
                {
                    "date": 1665632312182,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -37,9 +37,11 @@\n     Editor.make()\n       .config((ctx) => {\n         ctx.set(rootCtx, root),\n           ctx.set(defaultValueCtx, DEFAULT_MARKDOWN)\n-\n+          ctx.get(listenerCtx).markdownUpdated((ctx, markdown, prevMarkdown) => {\n+            console.log(markdown)\n+          })\n       })\n       .use(nord)\n       .use(commonmark)\n       .use(history)\n"
                },
                {
                    "date": 1665632376682,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -35,13 +35,13 @@\n export const MilkdownEditor: React.FC<MilkdownEditor> = () => {\n   const { editor, getInstance } = useEditor((root) =>\n     Editor.make()\n       .config((ctx) => {\n-        ctx.set(rootCtx, root),\n+          ctx.set(rootCtx, root),\n           ctx.set(defaultValueCtx, DEFAULT_MARKDOWN)\n-          ctx.get(listenerCtx).markdownUpdated((ctx, markdown, prevMarkdown) => {\n-            console.log(markdown)\n-          })\n+          // ctx.get(listenerCtx).markdownUpdated((ctx, markdown, prevMarkdown) => {\n+          //   console.log(markdown)\n+          // })\n       })\n       .use(nord)\n       .use(commonmark)\n       .use(history)\n@@ -52,9 +52,9 @@\n   const instance = getInstance()\n   instance?.action((ctx) => {\n     ctx.get(themeManagerCtx).switch(ctx, nordDark)\n   })\n-  instance?.config(ctx =>{\n+   instance?.config(ctx =>{\n     ctx.get(listenerCtx).markdownUpdated((ctx, markdown, prevMarkdown) => {\n       console.log(markdown)\n     })\n \n"
                },
                {
                    "date": 1665632588624,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -4,9 +4,9 @@\n import { ReactEditor, useEditor } from '@milkdown/react'\n // 通用markdown预设\n import { commonmark } from '@milkdown/preset-commonmark'\n import { history } from '@milkdown/plugin-history'\n-\n+import {useConfig} from './hooks/useConfig' \n import { listenerCtx, listener } from '@milkdown/plugin-listener'\n import { prism } from '@milkdown/plugin-prism'\n import { menu } from '@milkdown/plugin-menu'\n import { themeManagerCtx } from '@milkdown/core'\n@@ -37,11 +37,9 @@\n     Editor.make()\n       .config((ctx) => {\n           ctx.set(rootCtx, root),\n           ctx.set(defaultValueCtx, DEFAULT_MARKDOWN)\n-          // ctx.get(listenerCtx).markdownUpdated((ctx, markdown, prevMarkdown) => {\n-          //   console.log(markdown)\n-          // })\n+          useConfig(ctx)\n       })\n       .use(nord)\n       .use(commonmark)\n       .use(history)\n@@ -52,14 +50,8 @@\n   const instance = getInstance()\n   instance?.action((ctx) => {\n     ctx.get(themeManagerCtx).switch(ctx, nordDark)\n   })\n-   instance?.config(ctx =>{\n-    ctx.get(listenerCtx).markdownUpdated((ctx, markdown, prevMarkdown) => {\n-      console.log(markdown)\n-    })\n-\n-  })\n   useEffect(() => {\n     const handleRightClick = () => {\n       console.log('right-click')\n     }\n"
                },
                {
                    "date": 1665632837995,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,13 +1,13 @@\n-import React, { useEffect, useState } from 'react'\n-import { defaultValueCtx, Editor, editorViewCtx, rootCtx, serializerCtx } from '@milkdown/core'\n+import React, { useEffect } from 'react'\n+import { Editor, rootCtx } from '@milkdown/core'\n import { nord } from '@milkdown/theme-nord'\n import { ReactEditor, useEditor } from '@milkdown/react'\n // 通用markdown预设\n import { commonmark } from '@milkdown/preset-commonmark'\n import { history } from '@milkdown/plugin-history'\n import {useConfig} from './hooks/useConfig' \n-import { listenerCtx, listener } from '@milkdown/plugin-listener'\n+import { listener } from '@milkdown/plugin-listener'\n import { prism } from '@milkdown/plugin-prism'\n import { menu } from '@milkdown/plugin-menu'\n import { themeManagerCtx } from '@milkdown/core'\n // 亮色主题\n@@ -20,13 +20,9 @@\n import 'katex/dist/katex.min.css'\n // 代码高亮\n import 'prism-themes/themes/prism-material-oceanic.min.css'\n interface MilkdownEditor {}\n-const DEFAULT_MARKDOWN = `# H1\n-## H2\n-### H3\n-#### H4\n-###### H5`\n+\n window.api.onUpdateEditor((e,value)=>{\n   console.log(e)\n   console.log(value)\n })\n@@ -36,9 +32,8 @@\n   const { editor, getInstance } = useEditor((root) =>\n     Editor.make()\n       .config((ctx) => {\n           ctx.set(rootCtx, root),\n-          ctx.set(defaultValueCtx, DEFAULT_MARKDOWN)\n           useConfig(ctx)\n       })\n       .use(nord)\n       .use(commonmark)\n@@ -50,13 +45,14 @@\n   const instance = getInstance()\n   instance?.action((ctx) => {\n     ctx.get(themeManagerCtx).switch(ctx, nordDark)\n   })\n+  // 右键菜单\n   useEffect(() => {\n     const handleRightClick = () => {\n       console.log('right-click')\n     }\n-    const editor = document.querySelector('.editor')\n+    const editor = document.querySelector('.milkdown')\n     editor?.addEventListener('contextmenu', handleRightClick)\n     return editor?.removeEventListener('contextmenu', handleRightClick)\n   })\n   return <ReactEditor editor={editor} />\n"
                },
                {
                    "date": 1665633714401,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,6 +1,6 @@\n import React, { useEffect } from 'react'\n-import { Editor, rootCtx } from '@milkdown/core'\n+import { defaultValueCtx, Editor, rootCtx } from '@milkdown/core'\n import { nord } from '@milkdown/theme-nord'\n import { ReactEditor, useEditor } from '@milkdown/react'\n // 通用markdown预设\n import { commonmark } from '@milkdown/preset-commonmark'\n@@ -19,22 +19,25 @@\n // 数学公式渲染\n import 'katex/dist/katex.min.css'\n // 代码高亮\n import 'prism-themes/themes/prism-material-oceanic.min.css'\n-interface MilkdownEditor {}\n+interface MilkdownEditor {\n+  markdown:string\n+}\n \n window.api.onUpdateEditor((e,value)=>{\n   console.log(e)\n   console.log(value)\n })\n \n \n-export const MilkdownEditor: React.FC<MilkdownEditor> = () => {\n+export const MilkdownEditor: React.FC<MilkdownEditor> = ({markdown}) => {\n   const { editor, getInstance } = useEditor((root) =>\n     Editor.make()\n       .config((ctx) => {\n           ctx.set(rootCtx, root),\n-          useConfig(ctx)\n+          ctx.set(defaultValueCtx, markdown)\n+          // useConfig(ctx)\n       })\n       .use(nord)\n       .use(commonmark)\n       .use(history)\n"
                },
                {
                    "date": 1665633847510,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -34,9 +34,9 @@\n   const { editor, getInstance } = useEditor((root) =>\n     Editor.make()\n       .config((ctx) => {\n           ctx.set(rootCtx, root),\n-          ctx.set(defaultValueCtx, markdown)\n+          ctx.set(defaultValueCtx, '')\n           // useConfig(ctx)\n       })\n       .use(nord)\n       .use(commonmark)\n"
                },
                {
                    "date": 1665633864984,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -34,9 +34,9 @@\n   const { editor, getInstance } = useEditor((root) =>\n     Editor.make()\n       .config((ctx) => {\n           ctx.set(rootCtx, root),\n-          ctx.set(defaultValueCtx, '')\n+          ctx.set(defaultValueCtx, markdown)\n           // useConfig(ctx)\n       })\n       .use(nord)\n       .use(commonmark)\n"
                },
                {
                    "date": 1665634017801,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -30,8 +30,9 @@\n })\n \n \n export const MilkdownEditor: React.FC<MilkdownEditor> = ({markdown}) => {\n+  console.log(markdown)\n   const { editor, getInstance } = useEditor((root) =>\n     Editor.make()\n       .config((ctx) => {\n           ctx.set(rootCtx, root),\n"
                },
                {
                    "date": 1665635050058,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,8 +1,8 @@\n-import React, { useEffect } from 'react'\n-import { defaultValueCtx, Editor, rootCtx } from '@milkdown/core'\n+import React, { useEffect, useRef, useState } from 'react'\n+import { Ctx, defaultValueCtx, Editor, editorViewCtx, parserCtx, rootCtx } from '@milkdown/core'\n import { nord } from '@milkdown/theme-nord'\n-import { ReactEditor, useEditor } from '@milkdown/react'\n+import { EditorRef, ReactEditor, useEditor } from '@milkdown/react'\n // 通用markdown预设\n import { commonmark } from '@milkdown/preset-commonmark'\n import { history } from '@milkdown/plugin-history'\n import {useConfig} from './hooks/useConfig' \n@@ -19,45 +19,50 @@\n // 数学公式渲染\n import 'katex/dist/katex.min.css'\n // 代码高亮\n import 'prism-themes/themes/prism-material-oceanic.min.css'\n-interface MilkdownEditor {\n-  markdown:string\n-}\n+import { Slice } from \"prosemirror-model\";\n \n-window.api.onUpdateEditor((e,value)=>{\n-  console.log(e)\n-  console.log(value)\n-})\n+const MilkdownEditor: React.FC = () => {\n+  const editorRef = useRef<EditorRef | null>(null);\n+  const [isContentLoaded, setContentLoaded] = useState<boolean>(false);\n \n+const {editor}= useEditor(\n+      (root) => {\n+        return new Editor()\n+            .config((ctx) => {\n+                ctx.set(rootCtx, root);\n+                ctx.set(defaultValueCtx, \"Default value\");\n+            })\n+            .use(commonmark)\n+            .use(listener)\n+            .use(history);\n+      },\n+      [],\n+  );\n \n-export const MilkdownEditor: React.FC<MilkdownEditor> = ({markdown}) => {\n-  console.log(markdown)\n-  const { editor, getInstance } = useEditor((root) =>\n-    Editor.make()\n-      .config((ctx) => {\n-          ctx.set(rootCtx, root),\n-          ctx.set(defaultValueCtx, markdown)\n-          // useConfig(ctx)\n-      })\n-      .use(nord)\n-      .use(commonmark)\n-      .use(history)\n-      .use(listener)\n-      .use(prism)\n-      .use(menu)\n-  )\n-  const instance = getInstance()\n-  instance?.action((ctx) => {\n-    ctx.get(themeManagerCtx).switch(ctx, nordDark)\n-  })\n-  // 右键菜单\n-  useEffect(() => {\n-    const handleRightClick = () => {\n-      console.log('right-click')\n+useEffect(() => {\n+   if (editorRef.current) {\n+      const editor = editorRef.current.get();\n+      if (editor) {\n+        editor.action((ctx: Ctx) => {\n+          const view = ctx.get(editorViewCtx);\n+          const parser = ctx.get(parserCtx);\n+          const doc = parser('Content changed !!!');\n+          if (!doc) return;\n+          const state = view.state;\n+          view.dispatch(\n+            state.tr.replace(\n+              0,\n+              state.doc.content.size,\n+              new Slice(doc.content, 0, 0)\n+            )\n+          );\n+        });\n+      }\n     }\n-    const editor = document.querySelector('.milkdown')\n-    editor?.addEventListener('contextmenu', handleRightClick)\n-    return editor?.removeEventListener('contextmenu', handleRightClick)\n-  })\n-  return <ReactEditor editor={editor} />\n-}\n+},[isContentLoaded])\n+\n+  return <ReactEditor ref={editorRef} editor={editor} />;\n+};\n+\n+export default MilkdownEditor;\n\\ No newline at end of file\n"
                },
                {
                    "date": 1665635085574,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -21,9 +21,9 @@\n // 代码高亮\n import 'prism-themes/themes/prism-material-oceanic.min.css'\n import { Slice } from \"prosemirror-model\";\n \n-const MilkdownEditor: React.FC = () => {\n+export const MilkdownEditor: React.FC = () => {\n   const editorRef = useRef<EditorRef | null>(null);\n   const [isContentLoaded, setContentLoaded] = useState<boolean>(false);\n \n const {editor}= useEditor(\n@@ -63,6 +63,4 @@\n },[isContentLoaded])\n \n   return <ReactEditor ref={editorRef} editor={editor} />;\n };\n-\n-export default MilkdownEditor;\n\\ No newline at end of file\n"
                },
                {
                    "date": 1665635099541,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -21,9 +21,9 @@\n // 代码高亮\n import 'prism-themes/themes/prism-material-oceanic.min.css'\n import { Slice } from \"prosemirror-model\";\n \n-export const MilkdownEditor: React.FC = () => {\n+export const MilkEditor: React.FC = () => {\n   const editorRef = useRef<EditorRef | null>(null);\n   const [isContentLoaded, setContentLoaded] = useState<boolean>(false);\n \n const {editor}= useEditor(\n"
                },
                {
                    "date": 1665635129595,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -21,9 +21,9 @@\n // 代码高亮\n import 'prism-themes/themes/prism-material-oceanic.min.css'\n import { Slice } from \"prosemirror-model\";\n \n-export const MilkEditor: React.FC = () => {\n+export const MilkdownEditor: React.FC = () => {\n   const editorRef = useRef<EditorRef | null>(null);\n   const [isContentLoaded, setContentLoaded] = useState<boolean>(false);\n \n const {editor}= useEditor(\n"
                },
                {
                    "date": 1665635273367,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -38,29 +38,29 @@\n             .use(history);\n       },\n       [],\n   );\n-\n-useEffect(() => {\n-   if (editorRef.current) {\n-      const editor = editorRef.current.get();\n-      if (editor) {\n-        editor.action((ctx: Ctx) => {\n-          const view = ctx.get(editorViewCtx);\n-          const parser = ctx.get(parserCtx);\n-          const doc = parser('Content changed !!!');\n-          if (!doc) return;\n-          const state = view.state;\n-          view.dispatch(\n-            state.tr.replace(\n-              0,\n-              state.doc.content.size,\n-              new Slice(doc.content, 0, 0)\n-            )\n-          );\n-        });\n-      }\n+setTimeout(()=>{\n+  if (editorRef.current) {\n+    const editor = editorRef.current.get();\n+    if (editor) {\n+      editor.action((ctx: Ctx) => {\n+        const view = ctx.get(editorViewCtx);\n+        const parser = ctx.get(parserCtx);\n+        const doc = parser('Content changed !!!');\n+        if (!doc) return;\n+        const state = view.state;\n+        view.dispatch(\n+          state.tr.replace(\n+            0,\n+            state.doc.content.size,\n+            new Slice(doc.content, 0, 0)\n+          )\n+        );\n+      });\n     }\n-},[isContentLoaded])\n+  }\n+  console.log('chamge')\n+},3000)\n \n   return <ReactEditor ref={editorRef} editor={editor} />;\n };\n"
                },
                {
                    "date": 1665635288242,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -45,9 +45,9 @@\n     if (editor) {\n       editor.action((ctx: Ctx) => {\n         const view = ctx.get(editorViewCtx);\n         const parser = ctx.get(parserCtx);\n-        const doc = parser('Content changed !!!');\n+        const doc = parser('## Content changed !!!');\n         if (!doc) return;\n         const state = view.state;\n         view.dispatch(\n           state.tr.replace(\n"
                },
                {
                    "date": 1665636113634,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -20,47 +20,67 @@\n import 'katex/dist/katex.min.css'\n // 代码高亮\n import 'prism-themes/themes/prism-material-oceanic.min.css'\n import { Slice } from \"prosemirror-model\";\n+import React, { useEffect } from 'react'\n+import { defaultValueCtx, Editor, rootCtx } from '@milkdown/core'\n+import { nord } from '@milkdown/theme-nord'\n+import { ReactEditor, useEditor } from '@milkdown/react'\n+// 通用markdown预设\n+import { commonmark } from '@milkdown/preset-commonmark'\n+import { history } from '@milkdown/plugin-history'\n+import {useConfig} from './hooks/useConfig' \n+import { listener } from '@milkdown/plugin-listener'\n+import { prism } from '@milkdown/plugin-prism'\n+import { menu } from '@milkdown/plugin-menu'\n+import { themeManagerCtx } from '@milkdown/core'\n+// 亮色主题\n+import { nordLight } from '@milkdown/theme-nord'\n+// 暗色主题\n+import { nordDark } from '@milkdown/theme-nord'\n+// 官方引用的图标库，如菜单栏需要使用到\n+import '@material-design-icons/font'\n+// 数学公式渲染\n+import 'katex/dist/katex.min.css'\n+// 代码高亮\n+import 'prism-themes/themes/prism-material-oceanic.min.css'\n+interface MilkdownEditor {\n+  markdown:string\n+}\n \n-export const MilkdownEditor: React.FC = () => {\n-  const editorRef = useRef<EditorRef | null>(null);\n-  const [isContentLoaded, setContentLoaded] = useState<boolean>(false);\n+window.api.onUpdateEditor((e,value)=>{\n+  console.log(e)\n+  console.log(value)\n+})\n \n-const {editor}= useEditor(\n-      (root) => {\n-        return new Editor()\n-            .config((ctx) => {\n-                ctx.set(rootCtx, root);\n-                ctx.set(defaultValueCtx, \"Default value\");\n-            })\n-            .use(commonmark)\n-            .use(listener)\n-            .use(history);\n-      },\n-      [],\n-  );\n-setTimeout(()=>{\n-  if (editorRef.current) {\n-    const editor = editorRef.current.get();\n-    if (editor) {\n-      editor.action((ctx: Ctx) => {\n-        const view = ctx.get(editorViewCtx);\n-        const parser = ctx.get(parserCtx);\n-        const doc = parser('## Content changed !!!');\n-        if (!doc) return;\n-        const state = view.state;\n-        view.dispatch(\n-          state.tr.replace(\n-            0,\n-            state.doc.content.size,\n-            new Slice(doc.content, 0, 0)\n-          )\n-        );\n-      });\n+\n+export const MilkdownEditor: React.FC<MilkdownEditor> = ({markdown}) => {\n+  console.log(markdown)\n+  const { editor, getInstance } = useEditor((root) =>\n+    Editor.make()\n+      .config((ctx) => {\n+          ctx.set(rootCtx, root),\n+          ctx.set(defaultValueCtx, markdown)\n+          // useConfig(ctx)\n+      })\n+      .use(nord)\n+      .use(commonmark)\n+      .use(history)\n+      .use(listener)\n+      .use(prism)\n+      .use(menu)\n+  )\n+  const instance = getInstance()\n+  instance?.action((ctx) => {\n+    ctx.get(themeManagerCtx).switch(ctx, nordDark)\n+  })\n+  // 右键菜单\n+  useEffect(() => {\n+    const handleRightClick = () => {\n+      console.log('right-click')\n     }\n-  }\n-  console.log('chamge')\n-},3000)\n-\n-  return <ReactEditor ref={editorRef} editor={editor} />;\n-};\n+    const editor = document.querySelector('.milkdown')\n+    editor?.addEventListener('contextmenu', handleRightClick)\n+    return editor?.removeEventListener('contextmenu', handleRightClick)\n+  })\n+  return <ReactEditor editor={editor} />\n+}\n\\ No newline at end of file\n"
                },
                {
                    "date": 1665636331998,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -4,9 +4,9 @@\n import { EditorRef, ReactEditor, useEditor } from '@milkdown/react'\n // 通用markdown预设\n import { commonmark } from '@milkdown/preset-commonmark'\n import { history } from '@milkdown/plugin-history'\n-import {useConfig} from './hooks/useConfig' \n+import { useConfig } from './hooks/useConfig'\n import { listener } from '@milkdown/plugin-listener'\n import { prism } from '@milkdown/plugin-prism'\n import { menu } from '@milkdown/plugin-menu'\n import { themeManagerCtx } from '@milkdown/core'\n@@ -19,17 +19,17 @@\n // 数学公式渲染\n import 'katex/dist/katex.min.css'\n // 代码高亮\n import 'prism-themes/themes/prism-material-oceanic.min.css'\n-import { Slice } from \"prosemirror-model\";\n+import { Slice } from 'prosemirror-model'\n import React, { useEffect } from 'react'\n import { defaultValueCtx, Editor, rootCtx } from '@milkdown/core'\n import { nord } from '@milkdown/theme-nord'\n import { ReactEditor, useEditor } from '@milkdown/react'\n // 通用markdown预设\n import { commonmark } from '@milkdown/preset-commonmark'\n import { history } from '@milkdown/plugin-history'\n-import {useConfig} from './hooks/useConfig' \n+import { useConfig } from './hooks/useConfig'\n import { listener } from '@milkdown/plugin-listener'\n import { prism } from '@milkdown/plugin-prism'\n import { menu } from '@milkdown/plugin-menu'\n import { themeManagerCtx } from '@milkdown/core'\n@@ -43,25 +43,23 @@\n import 'katex/dist/katex.min.css'\n // 代码高亮\n import 'prism-themes/themes/prism-material-oceanic.min.css'\n interface MilkdownEditor {\n-  markdown:string\n+  markdown: string\n }\n \n-window.api.onUpdateEditor((e,value)=>{\n+window.api.onUpdateEditor((e, value) => {\n   console.log(e)\n   console.log(value)\n })\n \n-\n-export const MilkdownEditor: React.FC<MilkdownEditor> = ({markdown}) => {\n-  console.log(markdown)\n+export const MilkdownEditor: React.FC<MilkdownEditor> = ({ markdown }) => {\n+  const [content, setContent] = useState('')\n   const { editor, getInstance } = useEditor((root) =>\n     Editor.make()\n       .config((ctx) => {\n-          ctx.set(rootCtx, root),\n-          ctx.set(defaultValueCtx, markdown)\n-          // useConfig(ctx)\n+        ctx.set(rootCtx, root), ctx.set(defaultValueCtx, markdown)\n+        // useConfig(ctx)\n       })\n       .use(nord)\n       .use(commonmark)\n       .use(history)\n@@ -81,6 +79,16 @@\n     const editor = document.querySelector('.milkdown')\n     editor?.addEventListener('contextmenu', handleRightClick)\n     return editor?.removeEventListener('contextmenu', handleRightClick)\n   })\n+  useEffect(() => {\n+    instance?.action((ctx) => {\n\\ No newline at end of file\n+      const view = ctx.get(editorViewCtx)\n+      const parser = ctx.get(parserCtx)\n+      const doc = parser(content)\n+      if (!doc) return\n+      const state = view.state\n+      view.dispatch(state.tr.replace(0, state.doc.content.size, new Slice(doc.content, 0, 0)))\n+    })\n+  }, [content])\n   return <ReactEditor editor={editor} />\n-}\n+}\n"
                },
                {
                    "date": 1665636348482,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -42,18 +42,15 @@\n // 数学公式渲染\n import 'katex/dist/katex.min.css'\n // 代码高亮\n import 'prism-themes/themes/prism-material-oceanic.min.css'\n-interface MilkdownEditor {\n-  markdown: string\n-}\n \n window.api.onUpdateEditor((e, value) => {\n   console.log(e)\n   console.log(value)\n })\n \n-export const MilkdownEditor: React.FC<MilkdownEditor> = ({ markdown }) => {\n+export const MilkdownEditor: React.FC<MilkdownEditor> = () => {\n   const [content, setContent] = useState('')\n   const { editor, getInstance } = useEditor((root) =>\n     Editor.make()\n       .config((ctx) => {\n@@ -90,5 +87,5 @@\n       view.dispatch(state.tr.replace(0, state.doc.content.size, new Slice(doc.content, 0, 0)))\n     })\n   }, [content])\n   return <ReactEditor editor={editor} />\n-}\n\\ No newline at end of file\n+}\n"
                },
                {
                    "date": 1665636359652,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -42,8 +42,10 @@\n // 数学公式渲染\n import 'katex/dist/katex.min.css'\n // 代码高亮\n import 'prism-themes/themes/prism-material-oceanic.min.css'\n+interface MilkdownEditor {\n+}\n \n window.api.onUpdateEditor((e, value) => {\n   console.log(e)\n   console.log(value)\n"
                },
                {
                    "date": 1665636373245,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -42,10 +42,9 @@\n // 数学公式渲染\n import 'katex/dist/katex.min.css'\n // 代码高亮\n import 'prism-themes/themes/prism-material-oceanic.min.css'\n-interface MilkdownEditor {\n-}\n+interface MilkdownEditor {}\n \n window.api.onUpdateEditor((e, value) => {\n   console.log(e)\n   console.log(value)\n@@ -55,9 +54,9 @@\n   const [content, setContent] = useState('')\n   const { editor, getInstance } = useEditor((root) =>\n     Editor.make()\n       .config((ctx) => {\n-        ctx.set(rootCtx, root), ctx.set(defaultValueCtx, markdown)\n+        ctx.set(rootCtx, root), ctx.set(defaultValueCtx, content)\n         // useConfig(ctx)\n       })\n       .use(nord)\n       .use(commonmark)\n"
                },
                {
                    "date": 1665636394537,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -87,6 +87,9 @@\n       const state = view.state\n       view.dispatch(state.tr.replace(0, state.doc.content.size, new Slice(doc.content, 0, 0)))\n     })\n   }, [content])\n+  setTimeout(()=>{\n+setContent('# hello')\n+  },2000)\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1665636439299,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -19,30 +19,9 @@\n // 数学公式渲染\n import 'katex/dist/katex.min.css'\n // 代码高亮\n import 'prism-themes/themes/prism-material-oceanic.min.css'\n-import { Slice } from 'prosemirror-model'\n-import React, { useEffect } from 'react'\n-import { defaultValueCtx, Editor, rootCtx } from '@milkdown/core'\n-import { nord } from '@milkdown/theme-nord'\n-import { ReactEditor, useEditor } from '@milkdown/react'\n-// 通用markdown预设\n-import { commonmark } from '@milkdown/preset-commonmark'\n-import { history } from '@milkdown/plugin-history'\n-import { useConfig } from './hooks/useConfig'\n-import { listener } from '@milkdown/plugin-listener'\n-import { prism } from '@milkdown/plugin-prism'\n-import { menu } from '@milkdown/plugin-menu'\n-import { themeManagerCtx } from '@milkdown/core'\n-// 亮色主题\n-import { nordLight } from '@milkdown/theme-nord'\n-// 暗色主题\n-import { nordDark } from '@milkdown/theme-nord'\n-// 官方引用的图标库，如菜单栏需要使用到\n-import '@material-design-icons/font'\n-// 数学公式渲染\n-import 'katex/dist/katex.min.css'\n-// 代码高亮\n+\n import 'prism-themes/themes/prism-material-oceanic.min.css'\n interface MilkdownEditor {}\n \n window.api.onUpdateEditor((e, value) => {\n"
                },
                {
                    "date": 1665636470460,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -19,10 +19,9 @@\n // 数学公式渲染\n import 'katex/dist/katex.min.css'\n // 代码高亮\n import 'prism-themes/themes/prism-material-oceanic.min.css'\n-\n-import 'prism-themes/themes/prism-material-oceanic.min.css'\n+import { Slice } from \"prosemirror-model\";\n interface MilkdownEditor {}\n \n window.api.onUpdateEditor((e, value) => {\n   console.log(e)\n"
                },
                {
                    "date": 1665636482196,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -19,9 +19,9 @@\n // 数学公式渲染\n import 'katex/dist/katex.min.css'\n // 代码高亮\n import 'prism-themes/themes/prism-material-oceanic.min.css'\n-import { Slice } from \"prosemirror-model\";\n+import { Slice } from 'prosemirror-model'\n interface MilkdownEditor {}\n \n window.api.onUpdateEditor((e, value) => {\n   console.log(e)\n@@ -65,9 +65,9 @@\n       const state = view.state\n       view.dispatch(state.tr.replace(0, state.doc.content.size, new Slice(doc.content, 0, 0)))\n     })\n   }, [content])\n-  setTimeout(()=>{\n-setContent('# hello')\n-  },2000)\n+  setTimeout(() => {\n+    setContent('# hello')\n+  }, 2000)\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1665636497537,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -33,9 +33,9 @@\n   const { editor, getInstance } = useEditor((root) =>\n     Editor.make()\n       .config((ctx) => {\n         ctx.set(rootCtx, root), ctx.set(defaultValueCtx, content)\n-        // useConfig(ctx)\n+        useConfig(ctx)\n       })\n       .use(nord)\n       .use(commonmark)\n       .use(history)\n"
                },
                {
                    "date": 1665636514070,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -65,9 +65,6 @@\n       const state = view.state\n       view.dispatch(state.tr.replace(0, state.doc.content.size, new Slice(doc.content, 0, 0)))\n     })\n   }, [content])\n-  setTimeout(() => {\n-    setContent('# hello')\n-  }, 2000)\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1665637200874,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -22,13 +22,10 @@\n import 'prism-themes/themes/prism-material-oceanic.min.css'\n import { Slice } from 'prosemirror-model'\n interface MilkdownEditor {}\n \n-window.api.onUpdateEditor((e, value) => {\n-  console.log(e)\n-  console.log(value)\n-})\n \n+\n export const MilkdownEditor: React.FC<MilkdownEditor> = () => {\n   const [content, setContent] = useState('')\n   const { editor, getInstance } = useEditor((root) =>\n     Editor.make()\n@@ -55,8 +52,14 @@\n     const editor = document.querySelector('.milkdown')\n     editor?.addEventListener('contextmenu', handleRightClick)\n     return editor?.removeEventListener('contextmenu', handleRightClick)\n   })\n+  useEffect(()=>{\n+    console.log('listene')\n+    window.api.onUpdateEditor((e, value) => {\n+\n+    })\n+  },[])\n   useEffect(() => {\n     instance?.action((ctx) => {\n       const view = ctx.get(editorViewCtx)\n       const parser = ctx.get(parserCtx)\n"
                },
                {
                    "date": 1665637206306,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -55,9 +55,9 @@\n   })\n   useEffect(()=>{\n     console.log('listene')\n     window.api.onUpdateEditor((e, value) => {\n-\n+      console.log(value)\n     })\n   },[])\n   useEffect(() => {\n     instance?.action((ctx) => {\n"
                },
                {
                    "date": 1665637436049,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -57,9 +57,10 @@\n     console.log('listene')\n     window.api.onUpdateEditor((e, value) => {\n       console.log(value)\n     })\n-  },[])\n+    return window.api.onUpdateEditor = null\n+  })\n   useEffect(() => {\n     instance?.action((ctx) => {\n       const view = ctx.get(editorViewCtx)\n       const parser = ctx.get(parserCtx)\n"
                },
                {
                    "date": 1665637473424,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -57,10 +57,10 @@\n     console.log('listene')\n     window.api.onUpdateEditor((e, value) => {\n       console.log(value)\n     })\n-    return window.api.onUpdateEditor = null\n   })\n+  console.log(window.ap)\n   useEffect(() => {\n     instance?.action((ctx) => {\n       const view = ctx.get(editorViewCtx)\n       const parser = ctx.get(parserCtx)\n"
                },
                {
                    "date": 1665637527729,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -53,14 +53,13 @@\n     editor?.addEventListener('contextmenu', handleRightClick)\n     return editor?.removeEventListener('contextmenu', handleRightClick)\n   })\n   useEffect(()=>{\n-    console.log('listene')\n     window.api.onUpdateEditor((e, value) => {\n-      console.log(value)\n+      setContent(value)\n     })\n-  })\n-  console.log(window.ap)\n+  },[])\n+  console.log(window.api)\n   useEffect(() => {\n     instance?.action((ctx) => {\n       const view = ctx.get(editorViewCtx)\n       const parser = ctx.get(parserCtx)\n"
                },
                {
                    "date": 1665642819390,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -58,8 +58,9 @@\n       setContent(value)\n     })\n   },[])\n   console.log(window.api)\n+  // 更新内容\n   useEffect(() => {\n     instance?.action((ctx) => {\n       const view = ctx.get(editorViewCtx)\n       const parser = ctx.get(parserCtx)\n"
                },
                {
                    "date": 1665648058968,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -9,10 +9,11 @@\n import { listener } from '@milkdown/plugin-listener'\n import { prism } from '@milkdown/plugin-prism'\n import { menu } from '@milkdown/plugin-menu'\n import { themeManagerCtx } from '@milkdown/core'\n+import { clipboard } from '@milkdown/plugin-clipboard';\n // 亮色主题\n-import { nordLight } from '@milkdown/theme-nord'\n+// import { nordLight } from '@milkdown/theme-nord'\n // 暗色主题\n import { nordDark } from '@milkdown/theme-nord'\n // 官方引用的图标库，如菜单栏需要使用到\n import '@material-design-icons/font'\n@@ -38,8 +39,9 @@\n       .use(history)\n       .use(listener)\n       .use(prism)\n       .use(menu)\n+      .use(clipboard)\n   )\n   const instance = getInstance()\n   instance?.action((ctx) => {\n     ctx.get(themeManagerCtx).switch(ctx, nordDark)\n"
                },
                {
                    "date": 1665648086987,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -47,14 +47,14 @@\n     ctx.get(themeManagerCtx).switch(ctx, nordDark)\n   })\n   // 右键菜单\n   useEffect(() => {\n-    const handleRightClick = () => {\n-      console.log('right-click')\n-    }\n-    const editor = document.querySelector('.milkdown')\n-    editor?.addEventListener('contextmenu', handleRightClick)\n-    return editor?.removeEventListener('contextmenu', handleRightClick)\n+    // const handleRightClick = () => {\n+    //   console.log('right-click')\n+    // }\n+    // const editor = document.querySelector('.milkdown')\n+    // editor?.addEventListener('contextmenu', handleRightClick)\n+    // return editor?.removeEventListener('contextmenu', handleRightClick)\n   })\n   useEffect(()=>{\n     window.api.onUpdateEditor((e, value) => {\n       setContent(value)\n"
                },
                {
                    "date": 1665648100922,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -45,17 +45,17 @@\n   const instance = getInstance()\n   instance?.action((ctx) => {\n     ctx.get(themeManagerCtx).switch(ctx, nordDark)\n   })\n-  // 右键菜单\n-  useEffect(() => {\n-    // const handleRightClick = () => {\n-    //   console.log('right-click')\n-    // }\n-    // const editor = document.querySelector('.milkdown')\n-    // editor?.addEventListener('contextmenu', handleRightClick)\n-    // return editor?.removeEventListener('contextmenu', handleRightClick)\n-  })\n+  // // 右键菜单\n+  // useEffect(() => {\n+  //   const handleRightClick = () => {\n+  //     console.log('right-click')\n+  //   }\n+  //   const editor = document.querySelector('.milkdown')\n+  //   editor?.addEventListener('contextmenu', handleRightClick)\n+  //   return editor?.removeEventListener('contextmenu', handleRightClick)\n+  // })\n   useEffect(()=>{\n     window.api.onUpdateEditor((e, value) => {\n       setContent(value)\n     })\n"
                },
                {
                    "date": 1665648146776,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -54,23 +54,23 @@\n   //   const editor = document.querySelector('.milkdown')\n   //   editor?.addEventListener('contextmenu', handleRightClick)\n   //   return editor?.removeEventListener('contextmenu', handleRightClick)\n   // })\n-  useEffect(()=>{\n-    window.api.onUpdateEditor((e, value) => {\n-      setContent(value)\n-    })\n-  },[])\n-  console.log(window.api)\n-  // 更新内容\n-  useEffect(() => {\n-    instance?.action((ctx) => {\n-      const view = ctx.get(editorViewCtx)\n-      const parser = ctx.get(parserCtx)\n-      const doc = parser(content)\n-      if (!doc) return\n-      const state = view.state\n-      view.dispatch(state.tr.replace(0, state.doc.content.size, new Slice(doc.content, 0, 0)))\n-    })\n-  }, [content])\n+  // useEffect(()=>{\n+  //   window.api.onUpdateEditor((e, value) => {\n+  //     setContent(value)\n+  //   })\n+  // },[])\n+  // console.log(window.api)\n+  // // 更新内容\n+  // useEffect(() => {\n+  //   instance?.action((ctx) => {\n+  //     const view = ctx.get(editorViewCtx)\n+  //     const parser = ctx.get(parserCtx)\n+  //     const doc = parser(content)\n+  //     if (!doc) return\n+  //     const state = view.state\n+  //     view.dispatch(state.tr.replace(0, state.doc.content.size, new Slice(doc.content, 0, 0)))\n+  //   })\n+  // }, [content])\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1665648208690,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -45,32 +45,32 @@\n   const instance = getInstance()\n   instance?.action((ctx) => {\n     ctx.get(themeManagerCtx).switch(ctx, nordDark)\n   })\n-  // // 右键菜单\n-  // useEffect(() => {\n-  //   const handleRightClick = () => {\n-  //     console.log('right-click')\n-  //   }\n-  //   const editor = document.querySelector('.milkdown')\n-  //   editor?.addEventListener('contextmenu', handleRightClick)\n-  //   return editor?.removeEventListener('contextmenu', handleRightClick)\n-  // })\n-  // useEffect(()=>{\n-  //   window.api.onUpdateEditor((e, value) => {\n-  //     setContent(value)\n-  //   })\n-  // },[])\n-  // console.log(window.api)\n-  // // 更新内容\n-  // useEffect(() => {\n-  //   instance?.action((ctx) => {\n-  //     const view = ctx.get(editorViewCtx)\n-  //     const parser = ctx.get(parserCtx)\n-  //     const doc = parser(content)\n-  //     if (!doc) return\n-  //     const state = view.state\n-  //     view.dispatch(state.tr.replace(0, state.doc.content.size, new Slice(doc.content, 0, 0)))\n-  //   })\n-  // }, [content])\n+  // 右键菜单\n+  useEffect(() => {\n+    const handleRightClick = () => {\n+      console.log('right-click')\n+    }\n+    const editor = document.querySelector('.milkdown')\n+    editor?.addEventListener('contextmenu', handleRightClick)\n+    return editor?.removeEventListener('contextmenu', handleRightClick)\n+  })\n+  useEffect(()=>{\n+    window.api.onUpdateEditor((e, value) => {\n+      setContent(value)\n+    })\n+  },[])\n+  console.log(window.api)\n+  // 更新内容\n+  useEffect(() => {\n+    instance?.action((ctx) => {\n+      const view = ctx.get(editorViewCtx)\n+      const parser = ctx.get(parserCtx)\n+      const doc = parser(content)\n+      if (!doc) return\n+      const state = view.state\n+      view.dispatch(state.tr.replace(0, state.doc.content.size, new Slice(doc.content, 0, 0)))\n+    })\n+  }, [content])\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1665648487976,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -61,16 +61,16 @@\n     })\n   },[])\n   console.log(window.api)\n   // 更新内容\n-  useEffect(() => {\n-    instance?.action((ctx) => {\n-      const view = ctx.get(editorViewCtx)\n-      const parser = ctx.get(parserCtx)\n-      const doc = parser(content)\n-      if (!doc) return\n-      const state = view.state\n-      view.dispatch(state.tr.replace(0, state.doc.content.size, new Slice(doc.content, 0, 0)))\n-    })\n-  }, [content])\n+  // useEffect(() => {\n+  //   instance?.action((ctx) => {\n+  //     const view = ctx.get(editorViewCtx)\n+  //     const parser = ctx.get(parserCtx)\n+  //     const doc = parser(content)\n+  //     if (!doc) return\n+  //     const state = view.state\n+  //     view.dispatch(state.tr.replace(0, state.doc.content.size, new Slice(doc.content, 0, 0)))\n+  //   })\n+  // }, [content])\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1665648596384,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -61,16 +61,16 @@\n     })\n   },[])\n   console.log(window.api)\n   // 更新内容\n-  // useEffect(() => {\n-  //   instance?.action((ctx) => {\n-  //     const view = ctx.get(editorViewCtx)\n-  //     const parser = ctx.get(parserCtx)\n-  //     const doc = parser(content)\n-  //     if (!doc) return\n-  //     const state = view.state\n-  //     view.dispatch(state.tr.replace(0, state.doc.content.size, new Slice(doc.content, 0, 0)))\n-  //   })\n-  // }, [content])\n+  useEffect(() => {\n+    instance?.action((ctx) => {\n+      const view = ctx.get(editorViewCtx)\n+      const parser = ctx.get(parserCtx)\n+      const doc = parser(content)\n+      if (!doc) return\n+      const state = view.state\n+      view.dispatch(state.tr.replace(0, state.doc.content.size, new Slice(doc.content, 0, 0)))\n+    })\n+  }, [content])\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1665648641679,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -59,9 +59,8 @@\n     window.api.onUpdateEditor((e, value) => {\n       setContent(value)\n     })\n   },[])\n-  console.log(window.api)\n   // 更新内容\n   useEffect(() => {\n     instance?.action((ctx) => {\n       const view = ctx.get(editorViewCtx)\n"
                },
                {
                    "date": 1665671183875,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -10,8 +10,9 @@\n import { prism } from '@milkdown/plugin-prism'\n import { menu } from '@milkdown/plugin-menu'\n import { themeManagerCtx } from '@milkdown/core'\n import { clipboard } from '@milkdown/plugin-clipboard';\n+import { replaceAll } from '@milkdown/utils';\n // 亮色主题\n // import { nordLight } from '@milkdown/theme-nord'\n // 暗色主题\n import { nordDark } from '@milkdown/theme-nord'\n@@ -59,8 +60,9 @@\n     window.api.onUpdateEditor((e, value) => {\n       setContent(value)\n     })\n   },[])\n+instance?.action(replaceAll('# 12'))\n   // 更新内容\n   useEffect(() => {\n     instance?.action((ctx) => {\n       const view = ctx.get(editorViewCtx)\n"
                },
                {
                    "date": 1665671215647,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -60,18 +60,10 @@\n     window.api.onUpdateEditor((e, value) => {\n       setContent(value)\n     })\n   },[])\n-instance?.action(replaceAll('# 12'))\n   // 更新内容\n   useEffect(() => {\n-    instance?.action((ctx) => {\n-      const view = ctx.get(editorViewCtx)\n-      const parser = ctx.get(parserCtx)\n-      const doc = parser(content)\n-      if (!doc) return\n-      const state = view.state\n-      view.dispatch(state.tr.replace(0, state.doc.content.size, new Slice(doc.content, 0, 0)))\n-    })\n+    instance?.action(replaceAll(content))\n   }, [content])\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1665672886189,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -9,10 +9,10 @@\n import { listener } from '@milkdown/plugin-listener'\n import { prism } from '@milkdown/plugin-prism'\n import { menu } from '@milkdown/plugin-menu'\n import { themeManagerCtx } from '@milkdown/core'\n-import { clipboard } from '@milkdown/plugin-clipboard';\n-import { replaceAll } from '@milkdown/utils';\n+import { clipboard } from '@milkdown/plugin-clipboard'\n+import { replaceAll } from '@milkdown/utils'\n // 亮色主题\n // import { nordLight } from '@milkdown/theme-nord'\n // 暗色主题\n import { nordDark } from '@milkdown/theme-nord'\n@@ -21,13 +21,10 @@\n // 数学公式渲染\n import 'katex/dist/katex.min.css'\n // 代码高亮\n import 'prism-themes/themes/prism-material-oceanic.min.css'\n-import { Slice } from 'prosemirror-model'\n interface MilkdownEditor {}\n \n-\n-\n export const MilkdownEditor: React.FC<MilkdownEditor> = () => {\n   const [content, setContent] = useState('')\n   const { editor, getInstance } = useEditor((root) =>\n     Editor.make()\n@@ -55,13 +52,13 @@\n     const editor = document.querySelector('.milkdown')\n     editor?.addEventListener('contextmenu', handleRightClick)\n     return editor?.removeEventListener('contextmenu', handleRightClick)\n   })\n-  useEffect(()=>{\n-    window.api.onUpdateEditor((e, value) => {\n-      setContent(value)\n+  useEffect(() => {\n+    window.api.onUpdateEditor((e, { content }) => {\n+      setContent(content)\n     })\n-  },[])\n+  }, [])\n   // 更新内容\n   useEffect(() => {\n     instance?.action(replaceAll(content))\n   }, [content])\n"
                },
                {
                    "date": 1665762113741,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -21,12 +21,13 @@\n // 数学公式渲染\n import 'katex/dist/katex.min.css'\n // 代码高亮\n import 'prism-themes/themes/prism-material-oceanic.min.css'\n-interface MilkdownEditor {}\n+interface MilkdownEditor {\n+  content:string\n+}\n \n-export const MilkdownEditor: React.FC<MilkdownEditor> = () => {\n-  const [content, setContent] = useState('')\n+export const MilkdownEditor: React.FC<MilkdownEditor> = ({content}) => {\n   const { editor, getInstance } = useEditor((root) =>\n     Editor.make()\n       .config((ctx) => {\n         ctx.set(rootCtx, root), ctx.set(defaultValueCtx, content)\n@@ -52,13 +53,8 @@\n     const editor = document.querySelector('.milkdown')\n     editor?.addEventListener('contextmenu', handleRightClick)\n     return editor?.removeEventListener('contextmenu', handleRightClick)\n   })\n-  useEffect(() => {\n-    window.api.onUpdateEditor((e, { content }) => {\n-      setContent(content)\n-    })\n-  }, [])\n   // 更新内容\n   useEffect(() => {\n     instance?.action(replaceAll(content))\n   }, [content])\n"
                },
                {
                    "date": 1665762159059,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,8 +1,8 @@\n import React, { useEffect, useRef, useState } from 'react'\n import { Ctx, defaultValueCtx, Editor, editorViewCtx, parserCtx, rootCtx } from '@milkdown/core'\n import { nord } from '@milkdown/theme-nord'\n-import { EditorRef, ReactEditor, useEditor } from '@milkdown/react'\n+import {  ReactEditor, useEditor } from '@milkdown/react'\n // 通用markdown预设\n import { commonmark } from '@milkdown/preset-commonmark'\n import { history } from '@milkdown/plugin-history'\n import { useConfig } from './hooks/useConfig'\n"
                },
                {
                    "date": 1665762175947,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,6 +1,6 @@\n-import React, { useEffect, useRef, useState } from 'react'\n-import { Ctx, defaultValueCtx, Editor, editorViewCtx, parserCtx, rootCtx } from '@milkdown/core'\n+import React, { useEffect,} from 'react'\n+import {  defaultValueCtx, Editor, rootCtx } from '@milkdown/core'\n import { nord } from '@milkdown/theme-nord'\n import {  ReactEditor, useEditor } from '@milkdown/react'\n // 通用markdown预设\n import { commonmark } from '@milkdown/preset-commonmark'\n"
                },
                {
                    "date": 1665765847050,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -55,8 +55,8 @@\n     return editor?.removeEventListener('contextmenu', handleRightClick)\n   })\n   // 更新内容\n   useEffect(() => {\n-    instance?.action(replaceAll(content))\n+    instance?.action(replaceAll(content)).\n   }, [content])\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1665765854787,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -55,8 +55,8 @@\n     return editor?.removeEventListener('contextmenu', handleRightClick)\n   })\n   // 更新内容\n   useEffect(() => {\n-    instance?.action(replaceAll(content)).\n+    instance?.action(replaceAll(content).)\n   }, [content])\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1665909913544,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -11,8 +11,10 @@\n import { menu } from '@milkdown/plugin-menu'\n import { themeManagerCtx } from '@milkdown/core'\n import { clipboard } from '@milkdown/plugin-clipboard'\n import { replaceAll } from '@milkdown/utils'\n+import { gfm } from '@milkdown/preset-gfm';\n+\n // 亮色主题\n // import { nordLight } from '@milkdown/theme-nord'\n // 暗色主题\n import { nordDark } from '@milkdown/theme-nord'\n@@ -39,8 +41,9 @@\n       .use(listener)\n       .use(prism)\n       .use(menu)\n       .use(clipboard)\n+      .use(gfm)\n   )\n   const instance = getInstance()\n   instance?.action((ctx) => {\n     ctx.get(themeManagerCtx).switch(ctx, nordDark)\n@@ -55,8 +58,8 @@\n     return editor?.removeEventListener('contextmenu', handleRightClick)\n   })\n   // 更新内容\n   useEffect(() => {\n-    instance?.action(replaceAll(content).)\n+    instance?.action(replaceAll(content))\n   }, [content])\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1665909919272,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -40,9 +40,9 @@\n       .use(history)\n       .use(listener)\n       .use(prism)\n       .use(menu)\n-      .use(clipboard)\n+      // .use(clipboard)\n       .use(gfm)\n   )\n   const instance = getInstance()\n   instance?.action((ctx) => {\n"
                },
                {
                    "date": 1665909944316,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -40,9 +40,9 @@\n       .use(history)\n       .use(listener)\n       .use(prism)\n       .use(menu)\n-      // .use(clipboard)\n+      .use(clipboard)\n       .use(gfm)\n   )\n   const instance = getInstance()\n   instance?.action((ctx) => {\n"
                },
                {
                    "date": 1665909990689,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -35,9 +35,9 @@\n         ctx.set(rootCtx, root), ctx.set(defaultValueCtx, content)\n         useConfig(ctx)\n       })\n       .use(nord)\n-      .use(commonmark)\n+      // .use(commonmark)\n       .use(history)\n       .use(listener)\n       .use(prism)\n       .use(menu)\n"
                },
                {
                    "date": 1665910002258,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -35,15 +35,15 @@\n         ctx.set(rootCtx, root), ctx.set(defaultValueCtx, content)\n         useConfig(ctx)\n       })\n       .use(nord)\n-      // .use(commonmark)\n+      .use(commonmark)\n       .use(history)\n       .use(listener)\n       .use(prism)\n       .use(menu)\n       .use(clipboard)\n-      .use(gfm)\n+      // .use(gfm)\n   )\n   const instance = getInstance()\n   instance?.action((ctx) => {\n     ctx.get(themeManagerCtx).switch(ctx, nordDark)\n"
                },
                {
                    "date": 1665910054225,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -35,15 +35,15 @@\n         ctx.set(rootCtx, root), ctx.set(defaultValueCtx, content)\n         useConfig(ctx)\n       })\n       .use(nord)\n-      .use(commonmark)\n+      // .use(commonmark)\n       .use(history)\n       .use(listener)\n       .use(prism)\n       .use(menu)\n       .use(clipboard)\n-      // .use(gfm)\n+      .use(gfm)\n   )\n   const instance = getInstance()\n   instance?.action((ctx) => {\n     ctx.get(themeManagerCtx).switch(ctx, nordDark)\n"
                },
                {
                    "date": 1665910240867,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,18 +2,18 @@\n import {  defaultValueCtx, Editor, rootCtx } from '@milkdown/core'\n import { nord } from '@milkdown/theme-nord'\n import {  ReactEditor, useEditor } from '@milkdown/react'\n // 通用markdown预设\n-import { commonmark } from '@milkdown/preset-commonmark'\n+import { blockquote, commonmark } from '@milkdown/preset-commonmark'\n import { history } from '@milkdown/plugin-history'\n import { useConfig } from './hooks/useConfig'\n import { listener } from '@milkdown/plugin-listener'\n import { prism } from '@milkdown/plugin-prism'\n import { menu } from '@milkdown/plugin-menu'\n import { themeManagerCtx } from '@milkdown/core'\n import { clipboard } from '@milkdown/plugin-clipboard'\n import { replaceAll } from '@milkdown/utils'\n-import { gfm } from '@milkdown/preset-gfm';\n+import { gfm, SupportedKeys } from '@milkdown/preset-gfm';\n \n // 亮色主题\n // import { nordLight } from '@milkdown/theme-nord'\n // 暗色主题\n@@ -28,8 +28,13 @@\n   content:string\n }\n \n export const MilkdownEditor: React.FC<MilkdownEditor> = ({content}) => {\n+  const nodes = gfm.configure(blockquote, {\n+    keymap: {\n+        [SupportedKeys.Blockquote]: 'Mod-Shift-b',\n+    },\n+});\n   const { editor, getInstance } = useEditor((root) =>\n     Editor.make()\n       .config((ctx) => {\n         ctx.set(rootCtx, root), ctx.set(defaultValueCtx, content)\n@@ -41,10 +46,11 @@\n       .use(listener)\n       .use(prism)\n       .use(menu)\n       .use(clipboard)\n-      .use(gfm)\n+      .use(nodes)\n   )\n+\n   const instance = getInstance()\n   instance?.action((ctx) => {\n     ctx.get(themeManagerCtx).switch(ctx, nordDark)\n   })\n"
                },
                {
                    "date": 1665910255246,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -30,9 +30,9 @@\n \n export const MilkdownEditor: React.FC<MilkdownEditor> = ({content}) => {\n   const nodes = gfm.configure(blockquote, {\n     keymap: {\n-        [SupportedKeys.Blockquote]: 'Mod-Shift-b',\n+        [SupportedKeys.Blockquote]: 'Shift-b',\n     },\n });\n   const { editor, getInstance } = useEditor((root) =>\n     Editor.make()\n"
                },
                {
                    "date": 1665910270548,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,8 +1,8 @@\n-import React, { useEffect,} from 'react'\n-import {  defaultValueCtx, Editor, rootCtx } from '@milkdown/core'\n+import React, { useEffect } from 'react'\n+import { defaultValueCtx, Editor, rootCtx } from '@milkdown/core'\n import { nord } from '@milkdown/theme-nord'\n-import {  ReactEditor, useEditor } from '@milkdown/react'\n+import { ReactEditor, useEditor } from '@milkdown/react'\n // 通用markdown预设\n import { blockquote, commonmark } from '@milkdown/preset-commonmark'\n import { history } from '@milkdown/plugin-history'\n import { useConfig } from './hooks/useConfig'\n@@ -11,9 +11,9 @@\n import { menu } from '@milkdown/plugin-menu'\n import { themeManagerCtx } from '@milkdown/core'\n import { clipboard } from '@milkdown/plugin-clipboard'\n import { replaceAll } from '@milkdown/utils'\n-import { gfm, SupportedKeys } from '@milkdown/preset-gfm';\n+import { gfm, SupportedKeys } from '@milkdown/preset-gfm'\n \n // 亮色主题\n // import { nordLight } from '@milkdown/theme-nord'\n // 暗色主题\n@@ -24,17 +24,17 @@\n import 'katex/dist/katex.min.css'\n // 代码高亮\n import 'prism-themes/themes/prism-material-oceanic.min.css'\n interface MilkdownEditor {\n-  content:string\n+  content: string\n }\n \n-export const MilkdownEditor: React.FC<MilkdownEditor> = ({content}) => {\n+export const MilkdownEditor: React.FC<MilkdownEditor> = ({ content }) => {\n   const nodes = gfm.configure(blockquote, {\n     keymap: {\n-        [SupportedKeys.Blockquote]: 'Shift-b',\n-    },\n-});\n+      [SupportedKeys.Blockquote]: 'Shift-b'\n+    }\n+  })\n   const { editor, getInstance } = useEditor((root) =>\n     Editor.make()\n       .config((ctx) => {\n         ctx.set(rootCtx, root), ctx.set(defaultValueCtx, content)\n"
                },
                {
                    "date": 1665910734008,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,9 +2,9 @@\n import { defaultValueCtx, Editor, rootCtx } from '@milkdown/core'\n import { nord } from '@milkdown/theme-nord'\n import { ReactEditor, useEditor } from '@milkdown/react'\n // 通用markdown预设\n-import { blockquote, commonmark } from '@milkdown/preset-commonmark'\n+import { blockquote } from '@milkdown/preset-commonmark'\n import { history } from '@milkdown/plugin-history'\n import { useConfig } from './hooks/useConfig'\n import { listener } from '@milkdown/plugin-listener'\n import { prism } from '@milkdown/plugin-prism'\n@@ -40,9 +40,8 @@\n         ctx.set(rootCtx, root), ctx.set(defaultValueCtx, content)\n         useConfig(ctx)\n       })\n       .use(nord)\n-      // .use(commonmark)\n       .use(history)\n       .use(listener)\n       .use(prism)\n       .use(menu)\n"
                },
                {
                    "date": 1665922310731,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -11,9 +11,9 @@\n import { menu } from '@milkdown/plugin-menu'\n import { themeManagerCtx } from '@milkdown/core'\n import { clipboard } from '@milkdown/plugin-clipboard'\n import { replaceAll } from '@milkdown/utils'\n-import { gfm, SupportedKeys } from '@milkdown/preset-gfm'\n+import { gfm, SupportedKeys,codeFence } from '@milkdown/preset-gfm'\n \n // 亮色主题\n // import { nordLight } from '@milkdown/theme-nord'\n // 暗色主题\n@@ -32,15 +32,18 @@\n   const nodes = gfm.configure(blockquote, {\n     keymap: {\n       [SupportedKeys.Blockquote]: 'Shift-b'\n     }\n+  }).configure(codeFence,{\n+    languageList:['scss','javascript','css','html','typescript'],\n   })\n   const { editor, getInstance } = useEditor((root) =>\n     Editor.make()\n       .config((ctx) => {\n         ctx.set(rootCtx, root), ctx.set(defaultValueCtx, content)\n         useConfig(ctx)\n       })\n+      \n       .use(nord)\n       .use(history)\n       .use(listener)\n       .use(prism)\n"
                },
                {
                    "date": 1665923370071,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -11,9 +11,9 @@\n import { menu } from '@milkdown/plugin-menu'\n import { themeManagerCtx } from '@milkdown/core'\n import { clipboard } from '@milkdown/plugin-clipboard'\n import { replaceAll } from '@milkdown/utils'\n-import { gfm, SupportedKeys,codeFence } from '@milkdown/preset-gfm'\n+import { gfm, SupportedKeys,codeFence, taskListItem } from '@milkdown/preset-gfm'\n \n // 亮色主题\n // import { nordLight } from '@milkdown/theme-nord'\n // 暗色主题\n@@ -30,14 +30,20 @@\n \n export const MilkdownEditor: React.FC<MilkdownEditor> = ({ content }) => {\n   const nodes = gfm.configure(blockquote, {\n     keymap: {\n-      [SupportedKeys.Blockquote]: 'Shift-b'\n+      [SupportedKeys.Blockquote]: 'Shift-b',\n+      // [SupportedKeys.H1]:'shift-c',\n     }\n-  }).configure(codeFence,{\n+  })\n+  .configure(taskListItem,{\n+\n+  })\n+  .configure()\n+  .configure(codeFence,{\n     languageList:['scss','javascript','css','html','typescript'],\n   })\n-  const { editor, getInstance } = useEditor((root) =>\n+  const { editor,loading,getInstance } = useEditor((root) =>\n     Editor.make()\n       .config((ctx) => {\n         ctx.set(rootCtx, root), ctx.set(defaultValueCtx, content)\n         useConfig(ctx)\n@@ -51,12 +57,8 @@\n       .use(clipboard)\n       .use(nodes)\n   )\n \n-  const instance = getInstance()\n-  instance?.action((ctx) => {\n-    ctx.get(themeManagerCtx).switch(ctx, nordDark)\n-  })\n   // 右键菜单\n   useEffect(() => {\n     const handleRightClick = () => {\n       console.log('right-click')\n@@ -66,8 +68,15 @@\n     return editor?.removeEventListener('contextmenu', handleRightClick)\n   })\n   // 更新内容\n   useEffect(() => {\n-    instance?.action(replaceAll(content))\n-  }, [content])\n+    if(!loading) {\n+      const instance = getInstance()\n+      instance?.action(replaceAll(content))\n+      instance?.action((ctx) => {\n+        ctx.get(themeManagerCtx).switch(ctx, nordDark)\n+      })\n+\n+    }\n+  },[loading,content])\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1665925273750,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -11,9 +11,9 @@\n import { menu } from '@milkdown/plugin-menu'\n import { themeManagerCtx } from '@milkdown/core'\n import { clipboard } from '@milkdown/plugin-clipboard'\n import { replaceAll } from '@milkdown/utils'\n-import { gfm, SupportedKeys,codeFence, taskListItem } from '@milkdown/preset-gfm'\n+import { gfm, SupportedKeys, codeFence, taskListItem } from '@milkdown/preset-gfm'\n \n // 亮色主题\n // import { nordLight } from '@milkdown/theme-nord'\n // 暗色主题\n@@ -28,28 +28,27 @@\n   content: string\n }\n \n export const MilkdownEditor: React.FC<MilkdownEditor> = ({ content }) => {\n-  const nodes = gfm.configure(blockquote, {\n-    keymap: {\n-      [SupportedKeys.Blockquote]: 'Shift-b',\n-      // [SupportedKeys.H1]:'shift-c',\n-    }\n-  })\n-  .configure(taskListItem,{\n-\n-  })\n-  .configure()\n-  .configure(codeFence,{\n-    languageList:['scss','javascript','css','html','typescript'],\n-  })\n-  const { editor,loading,getInstance } = useEditor((root) =>\n+  const nodes = gfm\n+    .configure(blockquote, {\n+      keymap: {\n+        [SupportedKeys.Blockquote]: 'Shift-b'\n+        // [SupportedKeys.H1]:'shift-c',\n+      }\n+    })\n+    .configure(taskListItem, {})\n+    .configure()\n+    .configure(codeFence, {\n+      languageList: ['scss', 'javascript', 'css', 'html', 'typescript']\n+    })\n+  const { editor, loading, getInstance } = useEditor((root) =>\n     Editor.make()\n       .config((ctx) => {\n         ctx.set(rootCtx, root), ctx.set(defaultValueCtx, content)\n         useConfig(ctx)\n       })\n-      \n+\n       .use(nord)\n       .use(history)\n       .use(listener)\n       .use(prism)\n@@ -68,15 +67,14 @@\n     return editor?.removeEventListener('contextmenu', handleRightClick)\n   })\n   // 更新内容\n   useEffect(() => {\n-    if(!loading) {\n+    if (!loading) {\n       const instance = getInstance()\n       instance?.action(replaceAll(content))\n       instance?.action((ctx) => {\n         ctx.get(themeManagerCtx).switch(ctx, nordDark)\n       })\n-\n     }\n-  },[loading,content])\n+  }, [loading, content])\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1665928904519,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -36,9 +36,8 @@\n         // [SupportedKeys.H1]:'shift-c',\n       }\n     })\n     .configure(taskListItem, {})\n-    .configure()\n     .configure(codeFence, {\n       languageList: ['scss', 'javascript', 'css', 'html', 'typescript']\n     })\n   const { editor, loading, getInstance } = useEditor((root) =>\n"
                },
                {
                    "date": 1665929418716,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,9 +2,9 @@\n import { defaultValueCtx, Editor, rootCtx } from '@milkdown/core'\n import { nord } from '@milkdown/theme-nord'\n import { ReactEditor, useEditor } from '@milkdown/react'\n // 通用markdown预设\n-import { blockquote } from '@milkdown/preset-commonmark'\n+import { blockquote, commonmark } from '@milkdown/preset-commonmark'\n import { history } from '@milkdown/plugin-history'\n import { useConfig } from './hooks/useConfig'\n import { listener } from '@milkdown/plugin-listener'\n import { prism } from '@milkdown/plugin-prism'\n@@ -28,9 +28,9 @@\n   content: string\n }\n \n export const MilkdownEditor: React.FC<MilkdownEditor> = ({ content }) => {\n-  const nodes = gfm\n+  const gitHubCommonMark = gfm\n     .configure(blockquote, {\n       keymap: {\n         [SupportedKeys.Blockquote]: 'Shift-b'\n         // [SupportedKeys.H1]:'shift-c',\n@@ -45,16 +45,16 @@\n       .config((ctx) => {\n         ctx.set(rootCtx, root), ctx.set(defaultValueCtx, content)\n         useConfig(ctx)\n       })\n-\n+.use(commonmark)\n       .use(nord)\n       .use(history)\n       .use(listener)\n       .use(prism)\n       .use(menu)\n       .use(clipboard)\n-      .use(nodes)\n+      .use(gitHubCommonMark)\n   )\n \n   // 右键菜单\n   useEffect(() => {\n"
                },
                {
                    "date": 1665929449652,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -45,9 +45,9 @@\n       .config((ctx) => {\n         ctx.set(rootCtx, root), ctx.set(defaultValueCtx, content)\n         useConfig(ctx)\n       })\n-.use(commonmark)\n+      .use(commonmark)\n       .use(nord)\n       .use(history)\n       .use(listener)\n       .use(prism)\n"
                },
                {
                    "date": 1665929456336,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -45,9 +45,8 @@\n       .config((ctx) => {\n         ctx.set(rootCtx, root), ctx.set(defaultValueCtx, content)\n         useConfig(ctx)\n       })\n-      .use(commonmark)\n       .use(nord)\n       .use(history)\n       .use(listener)\n       .use(prism)\n"
                },
                {
                    "date": 1665929463904,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,9 +2,9 @@\n import { defaultValueCtx, Editor, rootCtx } from '@milkdown/core'\n import { nord } from '@milkdown/theme-nord'\n import { ReactEditor, useEditor } from '@milkdown/react'\n // 通用markdown预设\n-import { blockquote, commonmark } from '@milkdown/preset-commonmark'\n+import { blockquote} from '@milkdown/preset-commonmark'\n import { history } from '@milkdown/plugin-history'\n import { useConfig } from './hooks/useConfig'\n import { listener } from '@milkdown/plugin-listener'\n import { prism } from '@milkdown/plugin-prism'\n@@ -32,9 +32,8 @@\n   const gitHubCommonMark = gfm\n     .configure(blockquote, {\n       keymap: {\n         [SupportedKeys.Blockquote]: 'Shift-b'\n-        // [SupportedKeys.H1]:'shift-c',\n       }\n     })\n     .configure(taskListItem, {})\n     .configure(codeFence, {\n"
                },
                {
                    "date": 1665929472055,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -31,9 +31,9 @@\n export const MilkdownEditor: React.FC<MilkdownEditor> = ({ content }) => {\n   const gitHubCommonMark = gfm\n     .configure(blockquote, {\n       keymap: {\n-        [SupportedKeys.Blockquote]: 'Shift-b'\n+        [SupportedKeys.Blockquote]: 'Mod-q'\n       }\n     })\n     .configure(taskListItem, {})\n     .configure(codeFence, {\n"
                },
                {
                    "date": 1665929483282,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -31,9 +31,9 @@\n export const MilkdownEditor: React.FC<MilkdownEditor> = ({ content }) => {\n   const gitHubCommonMark = gfm\n     .configure(blockquote, {\n       keymap: {\n-        [SupportedKeys.Blockquote]: 'Mod-q'\n+        [SupportedKeys.Blockquote]: 'Mod-Shift-q'\n       }\n     })\n     .configure(taskListItem, {})\n     .configure(codeFence, {\n"
                },
                {
                    "date": 1666000214395,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -25,8 +25,9 @@\n // 代码高亮\n import 'prism-themes/themes/prism-material-oceanic.min.css'\n interface MilkdownEditor {\n   content: string\n+  filePath:string\n }\n \n export const MilkdownEditor: React.FC<MilkdownEditor> = ({ content }) => {\n   const gitHubCommonMark = gfm\n"
                },
                {
                    "date": 1666000485534,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -24,13 +24,15 @@\n import 'katex/dist/katex.min.css'\n // 代码高亮\n import 'prism-themes/themes/prism-material-oceanic.min.css'\n interface MilkdownEditor {\n-  content: string\n-  filePath:string\n+  file:{\n+    content: string\n+    filePath:string\n+  }\n }\n \n-export const MilkdownEditor: React.FC<MilkdownEditor> = ({ content }) => {\n+export const MilkdownEditor: React.FC<MilkdownEditor> = ({ file }) => {\n   const gitHubCommonMark = gfm\n     .configure(blockquote, {\n       keymap: {\n         [SupportedKeys.Blockquote]: 'Mod-Shift-q'\n@@ -42,10 +44,10 @@\n     })\n   const { editor, loading, getInstance } = useEditor((root) =>\n     Editor.make()\n       .config((ctx) => {\n-        ctx.set(rootCtx, root), ctx.set(defaultValueCtx, content)\n-        useConfig(ctx)\n+        ctx.set(rootCtx, root), ctx.set(defaultValueCtx, file.content)\n+        useConfig(ctx,file)\n       })\n       .use(nord)\n       .use(history)\n       .use(listener)\n"
                },
                {
                    "date": 1666012295909,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -69,12 +69,12 @@\n   // 更新内容\n   useEffect(() => {\n     if (!loading) {\n       const instance = getInstance()\n-      instance?.action(replaceAll(content))\n+      instance?.action(replaceAll(file.content))\n       instance?.action((ctx) => {\n         ctx.get(themeManagerCtx).switch(ctx, nordDark)\n       })\n     }\n-  }, [loading, content])\n+  }, [loading, file.content])\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1666013708487,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -24,15 +24,13 @@\n import 'katex/dist/katex.min.css'\n // 代码高亮\n import 'prism-themes/themes/prism-material-oceanic.min.css'\n interface MilkdownEditor {\n-  file:{\n-    content: string\n-    filePath:string\n-  }\n+  content:string,\n+  openedFile:string\n }\n \n-export const MilkdownEditor: React.FC<MilkdownEditor> = ({ file }) => {\n+export const MilkdownEditor: React.FC<MilkdownEditor> = ({ content,openedFile}) => {\n   const gitHubCommonMark = gfm\n     .configure(blockquote, {\n       keymap: {\n         [SupportedKeys.Blockquote]: 'Mod-Shift-q'\n"
                },
                {
                    "date": 1666013738035,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -42,10 +42,10 @@\n     })\n   const { editor, loading, getInstance } = useEditor((root) =>\n     Editor.make()\n       .config((ctx) => {\n-        ctx.set(rootCtx, root), ctx.set(defaultValueCtx, file.content)\n-        useConfig(ctx,file)\n+        ctx.set(rootCtx, root), ctx.set(defaultValueCtx, content)\n+        useConfig(ctx,{filePath:openedFile,content})\n       })\n       .use(nord)\n       .use(history)\n       .use(listener)\n"
                },
                {
                    "date": 1666013858187,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -67,12 +67,12 @@\n   // 更新内容\n   useEffect(() => {\n     if (!loading) {\n       const instance = getInstance()\n-      instance?.action(replaceAll(file.content))\n+      instance?.action(replaceAll(content))\n       instance?.action((ctx) => {\n         ctx.get(themeManagerCtx).switch(ctx, nordDark)\n       })\n     }\n-  }, [loading, file.content])\n+  }, [loading,content])\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1666014390585,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,57 +3,29 @@\n import { nord } from '@milkdown/theme-nord'\n import { ReactEditor, useEditor } from '@milkdown/react'\n // 通用markdown预设\n import { blockquote} from '@milkdown/preset-commonmark'\n-import { history } from '@milkdown/plugin-history'\n-import { useConfig } from './hooks/useConfig'\n import { listener } from '@milkdown/plugin-listener'\n import { prism } from '@milkdown/plugin-prism'\n import { menu } from '@milkdown/plugin-menu'\n import { themeManagerCtx } from '@milkdown/core'\n import { clipboard } from '@milkdown/plugin-clipboard'\n import { replaceAll } from '@milkdown/utils'\n import { gfm, SupportedKeys, codeFence, taskListItem } from '@milkdown/preset-gfm'\n \n-// 亮色主题\n-// import { nordLight } from '@milkdown/theme-nord'\n-// 暗色主题\n-import { nordDark } from '@milkdown/theme-nord'\n-// 官方引用的图标库，如菜单栏需要使用到\n-import '@material-design-icons/font'\n-// 数学公式渲染\n-import 'katex/dist/katex.min.css'\n-// 代码高亮\n-import 'prism-themes/themes/prism-material-oceanic.min.css'\n+\n interface MilkdownEditor {\n   content:string,\n   openedFile:string\n }\n \n export const MilkdownEditor: React.FC<MilkdownEditor> = ({ content,openedFile}) => {\n-  const gitHubCommonMark = gfm\n-    .configure(blockquote, {\n-      keymap: {\n-        [SupportedKeys.Blockquote]: 'Mod-Shift-q'\n-      }\n-    })\n-    .configure(taskListItem, {})\n-    .configure(codeFence, {\n-      languageList: ['scss', 'javascript', 'css', 'html', 'typescript']\n-    })\n+\n   const { editor, loading, getInstance } = useEditor((root) =>\n-    Editor.make()\n-      .config((ctx) => {\n-        ctx.set(rootCtx, root), ctx.set(defaultValueCtx, content)\n-        useConfig(ctx,{filePath:openedFile,content})\n-      })\n-      .use(nord)\n-      .use(history)\n-      .use(listener)\n-      .use(prism)\n-      .use(menu)\n-      .use(clipboard)\n-      .use(gitHubCommonMark)\n+  Editor.make()\n+   .config((ctx) => {\n+    ctx.set(rootCtx, root), ctx.set(defaultValueCtx, content)\n+  })\n   )\n \n   // 右键菜单\n   useEffect(() => {\n"
                },
                {
                    "date": 1666014691895,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,31 +2,53 @@\n import { defaultValueCtx, Editor, rootCtx } from '@milkdown/core'\n import { nord } from '@milkdown/theme-nord'\n import { ReactEditor, useEditor } from '@milkdown/react'\n // 通用markdown预设\n-import { blockquote} from '@milkdown/preset-commonmark'\n+import { blockquote } from '@milkdown/preset-commonmark'\n+import { history } from '@milkdown/plugin-history'\n+import { useConfig, usePlugins } from './hooks/usePlugins'\n import { listener } from '@milkdown/plugin-listener'\n import { prism } from '@milkdown/plugin-prism'\n import { menu } from '@milkdown/plugin-menu'\n import { themeManagerCtx } from '@milkdown/core'\n import { clipboard } from '@milkdown/plugin-clipboard'\n import { replaceAll } from '@milkdown/utils'\n import { gfm, SupportedKeys, codeFence, taskListItem } from '@milkdown/preset-gfm'\n \n-\n+// 亮色主题\n+// import { nordLight } from '@milkdown/theme-nord'\n+// 暗色主题\n+import { nordDark } from '@milkdown/theme-nord'\n+// 官方引用的图标库，如菜单栏需要使用到\n+import '@material-design-icons/font'\n+// 数学公式渲染\n+import 'katex/dist/katex.min.css'\n+// 代码高亮\n+import 'prism-themes/themes/prism-material-oceanic.min.css'\n interface MilkdownEditor {\n-  content:string,\n-  openedFile:string\n+  content: string\n+  openedFile: string\n }\n \n-export const MilkdownEditor: React.FC<MilkdownEditor> = ({ content,openedFile}) => {\n-\n-  const { editor, loading, getInstance } = useEditor((root) =>\n-  Editor.make()\n-   .config((ctx) => {\n-    ctx.set(rootCtx, root), ctx.set(defaultValueCtx, content)\n+export const MilkdownEditor: React.FC<MilkdownEditor> = ({ content, openedFile }) => {\n+  const gitHubCommonMark = gfm\n+    .configure(blockquote, {\n+      keymap: {\n+        [SupportedKeys.Blockquote]: 'Mod-Shift-q'\n+      }\n+    })\n+    .configure(taskListItem, {})\n+    .configure(codeFence, {\n+      languageList: ['scss', 'javascript', 'css', 'html', 'typescript']\n+    })\n+  const { editor, loading, getInstance } = useEditor((root) => {\n+    const newEditor = Editor.make()\n+    newEditor.config((ctx) => {\n+      ctx.set(rootCtx, root), ctx.set(defaultValueCtx, content)\n+      usePlugins(newEditor)\n+    })\n+    return newEditor\n   })\n-  )\n \n   // 右键菜单\n   useEffect(() => {\n     const handleRightClick = () => {\n@@ -44,7 +66,7 @@\n       instance?.action((ctx) => {\n         ctx.get(themeManagerCtx).switch(ctx, nordDark)\n       })\n     }\n-  }, [loading,content])\n+  }, [loading, content])\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1666015153011,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,19 +1,11 @@\n import React, { useEffect } from 'react'\n import { defaultValueCtx, Editor, rootCtx } from '@milkdown/core'\n-import { nord } from '@milkdown/theme-nord'\n+\n import { ReactEditor, useEditor } from '@milkdown/react'\n-// 通用markdown预设\n-import { blockquote } from '@milkdown/preset-commonmark'\n-import { history } from '@milkdown/plugin-history'\n-import { useConfig, usePlugins } from './hooks/usePlugins'\n-import { listener } from '@milkdown/plugin-listener'\n-import { prism } from '@milkdown/plugin-prism'\n-import { menu } from '@milkdown/plugin-menu'\n+import { usePlugins } from './hooks/usePlugins'\n import { themeManagerCtx } from '@milkdown/core'\n-import { clipboard } from '@milkdown/plugin-clipboard'\n import { replaceAll } from '@milkdown/utils'\n-import { gfm, SupportedKeys, codeFence, taskListItem } from '@milkdown/preset-gfm'\n \n // 亮色主题\n // import { nordLight } from '@milkdown/theme-nord'\n // 暗色主题\n@@ -23,30 +15,19 @@\n // 数学公式渲染\n import 'katex/dist/katex.min.css'\n // 代码高亮\n import 'prism-themes/themes/prism-material-oceanic.min.css'\n+import { useConfig } from './hooks/useConfig'\n interface MilkdownEditor {\n   content: string\n   openedFile: string\n }\n \n export const MilkdownEditor: React.FC<MilkdownEditor> = ({ content, openedFile }) => {\n-  const gitHubCommonMark = gfm\n-    .configure(blockquote, {\n-      keymap: {\n-        [SupportedKeys.Blockquote]: 'Mod-Shift-q'\n-      }\n-    })\n-    .configure(taskListItem, {})\n-    .configure(codeFence, {\n-      languageList: ['scss', 'javascript', 'css', 'html', 'typescript']\n-    })\n   const { editor, loading, getInstance } = useEditor((root) => {\n     const newEditor = Editor.make()\n-    newEditor.config((ctx) => {\n-      ctx.set(rootCtx, root), ctx.set(defaultValueCtx, content)\n-      usePlugins(newEditor)\n-    })\n+    useConfig(newEditor,root,content)\n+    usePlugins(newEditor)\n     return newEditor\n   })\n \n   // 右键菜单\n"
                },
                {
                    "date": 1666015208241,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -18,12 +18,11 @@\n import 'prism-themes/themes/prism-material-oceanic.min.css'\n import { useConfig } from './hooks/useConfig'\n interface MilkdownEditor {\n   content: string\n-  openedFile: string\n }\n \n-export const MilkdownEditor: React.FC<MilkdownEditor> = ({ content, openedFile }) => {\n+export const MilkdownEditor: React.FC<MilkdownEditor> = ({ content}) => {\n   const { editor, loading, getInstance } = useEditor((root) => {\n     const newEditor = Editor.make()\n     useConfig(newEditor,root,content)\n     usePlugins(newEditor)\n@@ -39,15 +38,15 @@\n     editor?.addEventListener('contextmenu', handleRightClick)\n     return editor?.removeEventListener('contextmenu', handleRightClick)\n   })\n   // 更新内容\n-  useEffect(() => {\n-    if (!loading) {\n-      const instance = getInstance()\n-      instance?.action(replaceAll(content))\n-      instance?.action((ctx) => {\n-        ctx.get(themeManagerCtx).switch(ctx, nordDark)\n-      })\n-    }\n-  }, [loading, content])\n+  // useEffect(() => {\n+  //   if (!loading) {\n+  //     const instance = getInstance()\n+  //     instance?.action(replaceAll(content))\n+  //     instance?.action((ctx) => {\n+  //       ctx.get(themeManagerCtx).switch(ctx, nordDark)\n+  //     })\n+  //   }\n+  // }, [loading, content])\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1666015460644,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -36,17 +36,17 @@\n     }\n     const editor = document.querySelector('.milkdown')\n     editor?.addEventListener('contextmenu', handleRightClick)\n     return editor?.removeEventListener('contextmenu', handleRightClick)\n-  })\n+  },[])\n   // 更新内容\n-  // useEffect(() => {\n-  //   if (!loading) {\n-  //     const instance = getInstance()\n-  //     instance?.action(replaceAll(content))\n-  //     instance?.action((ctx) => {\n-  //       ctx.get(themeManagerCtx).switch(ctx, nordDark)\n-  //     })\n-  //   }\n-  // }, [loading, content])\n+  useEffect(() => {\n+    if (!loading) {\n+      const instance = getInstance()\n+      instance?.action(replaceAll(content))\n+      instance?.action((ctx) => {\n+        ctx.get(themeManagerCtx).switch(ctx, nordDark)\n+      })\n+    }\n+  }, [loading, content])\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1666015535635,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -37,9 +37,9 @@\n     const editor = document.querySelector('.milkdown')\n     editor?.addEventListener('contextmenu', handleRightClick)\n     return editor?.removeEventListener('contextmenu', handleRightClick)\n   },[])\n-  // 更新内容\n+  // 这个组件更新内容不会随着prop变化，需要手动设置\n   useEffect(() => {\n     if (!loading) {\n       const instance = getInstance()\n       instance?.action(replaceAll(content))\n"
                },
                {
                    "date": 1666015910942,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -27,18 +27,8 @@\n     useConfig(newEditor,root,content)\n     usePlugins(newEditor)\n     return newEditor\n   })\n-\n-  // 右键菜单\n-  useEffect(() => {\n-    const handleRightClick = () => {\n-      console.log('right-click')\n-    }\n-    const editor = document.querySelector('.milkdown')\n-    editor?.addEventListener('contextmenu', handleRightClick)\n-    return editor?.removeEventListener('contextmenu', handleRightClick)\n-  },[])\n   // 这个组件更新内容不会随着prop变化，需要手动设置\n   useEffect(() => {\n     if (!loading) {\n       const instance = getInstance()\n"
                },
                {
                    "date": 1666016072445,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,22 +1,12 @@\n import React, { useEffect } from 'react'\n-import { defaultValueCtx, Editor, rootCtx } from '@milkdown/core'\n+import { Editor} from '@milkdown/core'\n \n import { ReactEditor, useEditor } from '@milkdown/react'\n import { usePlugins } from './hooks/usePlugins'\n import { themeManagerCtx } from '@milkdown/core'\n import { replaceAll } from '@milkdown/utils'\n-\n-// 亮色主题\n-// import { nordLight } from '@milkdown/theme-nord'\n-// 暗色主题\n import { nordDark } from '@milkdown/theme-nord'\n-// 官方引用的图标库，如菜单栏需要使用到\n-import '@material-design-icons/font'\n-// 数学公式渲染\n-import 'katex/dist/katex.min.css'\n-// 代码高亮\n-import 'prism-themes/themes/prism-material-oceanic.min.css'\n import { useConfig } from './hooks/useConfig'\n interface MilkdownEditor {\n   content: string\n }\n"
                },
                {
                    "date": 1666016131188,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -16,9 +16,9 @@\n     const newEditor = Editor.make()\n     useConfig(newEditor,root,content)\n     usePlugins(newEditor)\n     return newEditor\n-  })\n+  },[])\n   // 这个组件更新内容不会随着prop变化，需要手动设置\n   useEffect(() => {\n     if (!loading) {\n       const instance = getInstance()\n"
                },
                {
                    "date": 1666016427600,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -8,14 +8,15 @@\n import { nordDark } from '@milkdown/theme-nord'\n import { useConfig } from './hooks/useConfig'\n interface MilkdownEditor {\n   content: string\n+  filePath:string\n }\n \n-export const MilkdownEditor: React.FC<MilkdownEditor> = ({ content}) => {\n+export const MilkdownEditor: React.FC<MilkdownEditor> = ({ content,filePath}) => {\n   const { editor, loading, getInstance } = useEditor((root) => {\n     const newEditor = Editor.make()\n-    useConfig(newEditor,root,content)\n+    useConfig(newEditor,root,content,filePath)\n     usePlugins(newEditor)\n     return newEditor\n   },[])\n   // 这个组件更新内容不会随着prop变化，需要手动设置\n"
                },
                {
                    "date": 1666016712742,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -12,8 +12,9 @@\n   filePath:string\n }\n \n export const MilkdownEditor: React.FC<MilkdownEditor> = ({ content,filePath}) => {\n+  console.log('MilkdownEditor-component-updated')\n   const { editor, loading, getInstance } = useEditor((root) => {\n     const newEditor = Editor.make()\n     useConfig(newEditor,root,content,filePath)\n     usePlugins(newEditor)\n"
                },
                {
                    "date": 1666016854683,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -12,10 +12,10 @@\n   filePath:string\n }\n \n export const MilkdownEditor: React.FC<MilkdownEditor> = ({ content,filePath}) => {\n+  const { editor, loading, getInstance } = useEditor((root) => {\n   console.log('MilkdownEditor-component-updated')\n-  const { editor, loading, getInstance } = useEditor((root) => {\n     const newEditor = Editor.make()\n     useConfig(newEditor,root,content,filePath)\n     usePlugins(newEditor)\n     return newEditor\n"
                },
                {
                    "date": 1666016944366,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -12,12 +12,12 @@\n   filePath:string\n }\n \n export const MilkdownEditor: React.FC<MilkdownEditor> = ({ content,filePath}) => {\n+  // 组件更新时，useEditor不会被重新调用\n   const { editor, loading, getInstance } = useEditor((root) => {\n-  console.log('MilkdownEditor-component-updated')\n     const newEditor = Editor.make()\n-    useConfig(newEditor,root,content,filePath)\n+    useConfig(newEditor,root)\n     usePlugins(newEditor)\n     return newEditor\n   },[])\n   // 这个组件更新内容不会随着prop变化，需要手动设置\n"
                },
                {
                    "date": 1666060327892,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -6,8 +6,10 @@\n import { themeManagerCtx } from '@milkdown/core'\n import { replaceAll } from '@milkdown/utils'\n import { nordDark } from '@milkdown/theme-nord'\n import { useConfig } from './hooks/useConfig'\n+import { forceUpdate } from '@milkdown/utils';\n+\n interface MilkdownEditor {\n   content: string\n   filePath:string\n }\n@@ -19,8 +21,12 @@\n     useConfig(newEditor,root)\n     usePlugins(newEditor)\n     return newEditor\n   },[])\n+  setTimeout(()=>{\n+    const instance = getInstance()\n+    instance?.action(forceUpdate())\n+  },5000)\n   // 这个组件更新内容不会随着prop变化，需要手动设置\n   useEffect(() => {\n     if (!loading) {\n       const instance = getInstance()\n"
                },
                {
                    "date": 1666060382089,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -6,9 +6,9 @@\n import { themeManagerCtx } from '@milkdown/core'\n import { replaceAll } from '@milkdown/utils'\n import { nordDark } from '@milkdown/theme-nord'\n import { useConfig } from './hooks/useConfig'\n-import { forceUpdate } from '@milkdown/utils';\n+import { forceUpdate,outline } from '@milkdown/utils';\n \n interface MilkdownEditor {\n   content: string\n   filePath:string\n"
                },
                {
                    "date": 1666066160212,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -6,9 +6,9 @@\n import { themeManagerCtx } from '@milkdown/core'\n import { replaceAll } from '@milkdown/utils'\n import { nordDark } from '@milkdown/theme-nord'\n import { useConfig } from './hooks/useConfig'\n-import { forceUpdate,outline } from '@milkdown/utils';\n+import { forceUpdate} from '@milkdown/utils';\n \n interface MilkdownEditor {\n   content: string\n   filePath:string\n@@ -21,12 +21,8 @@\n     useConfig(newEditor,root)\n     usePlugins(newEditor)\n     return newEditor\n   },[])\n-  setTimeout(()=>{\n-    const instance = getInstance()\n-    instance?.action(forceUpdate())\n-  },5000)\n   // 这个组件更新内容不会随着prop变化，需要手动设置\n   useEffect(() => {\n     if (!loading) {\n       const instance = getInstance()\n"
                },
                {
                    "date": 1666066294396,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -6,10 +6,10 @@\n import { themeManagerCtx } from '@milkdown/core'\n import { replaceAll } from '@milkdown/utils'\n import { nordDark } from '@milkdown/theme-nord'\n import { useConfig } from './hooks/useConfig'\n-import { forceUpdate} from '@milkdown/utils';\n \n+\n interface MilkdownEditor {\n   content: string\n   filePath:string\n }\n"
                },
                {
                    "date": 1666081554380,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -21,8 +21,11 @@\n     useConfig(newEditor,root)\n     usePlugins(newEditor)\n     return newEditor\n   },[])\n+  useEffect(()=>{\n+console.log('change opend file')\n+  },[filePath])\n   // 这个组件更新内容不会随着prop变化，需要手动设置\n   useEffect(() => {\n     if (!loading) {\n       const instance = getInstance()\n"
                },
                {
                    "date": 1666081588032,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -22,9 +22,9 @@\n     usePlugins(newEditor)\n     return newEditor\n   },[])\n   useEffect(()=>{\n-console.log('change opend file')\n+console.log(filePath)\n   },[filePath])\n   // 这个组件更新内容不会随着prop变化，需要手动设置\n   useEffect(() => {\n     if (!loading) {\n"
                },
                {
                    "date": 1666081670726,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -22,8 +22,9 @@\n     usePlugins(newEditor)\n     return newEditor\n   },[])\n   useEffect(()=>{\n+    console.log(document.querySelector('h1'))\n console.log(filePath)\n   },[filePath])\n   // 这个组件更新内容不会随着prop变化，需要手动设置\n   useEffect(() => {\n"
                },
                {
                    "date": 1666081857430,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -22,16 +22,17 @@\n     usePlugins(newEditor)\n     return newEditor\n   },[])\n   useEffect(()=>{\n-    console.log(document.querySelector('h1'))\n console.log(filePath)\n   },[filePath])\n   // 这个组件更新内容不会随着prop变化，需要手动设置\n   useEffect(() => {\n     if (!loading) {\n       const instance = getInstance()\n       instance?.action(replaceAll(content))\n+    console.log(document.querySelector('h1'))\n+\n       instance?.action((ctx) => {\n         ctx.get(themeManagerCtx).switch(ctx, nordDark)\n       })\n     }\n"
                },
                {
                    "date": 1666081957250,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -6,8 +6,9 @@\n import { themeManagerCtx } from '@milkdown/core'\n import { replaceAll } from '@milkdown/utils'\n import { nordDark } from '@milkdown/theme-nord'\n import { useConfig } from './hooks/useConfig'\n+import { useUpdateHeaders } from '../SideBar/hooks/useUpdateHeader'\n \n \n interface MilkdownEditor {\n   content: string\n@@ -29,9 +30,9 @@\n   useEffect(() => {\n     if (!loading) {\n       const instance = getInstance()\n       instance?.action(replaceAll(content))\n-    console.log(document.querySelector('h1'))\n+      useUpdateHeaders()\n \n       instance?.action((ctx) => {\n         ctx.get(themeManagerCtx).switch(ctx, nordDark)\n       })\n"
                },
                {
                    "date": 1666082180888,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,6 +1,6 @@\n import React, { useEffect } from 'react'\n-import { Editor} from '@milkdown/core'\n+import { Editor } from '@milkdown/core'\n \n import { ReactEditor, useEditor } from '@milkdown/react'\n import { usePlugins } from './hooks/usePlugins'\n import { themeManagerCtx } from '@milkdown/core'\n@@ -8,32 +8,31 @@\n import { nordDark } from '@milkdown/theme-nord'\n import { useConfig } from './hooks/useConfig'\n import { useUpdateHeaders } from '../SideBar/hooks/useUpdateHeader'\n \n-\n interface MilkdownEditor {\n   content: string\n-  filePath:string\n+  filePath: string\n }\n \n-export const MilkdownEditor: React.FC<MilkdownEditor> = ({ content,filePath}) => {\n+export const MilkdownEditor: React.FC<MilkdownEditor> = ({ content, filePath }) => {\n+  console.log('MilkdownEditor-update')\n   // 组件更新时，useEditor不会被重新调用\n   const { editor, loading, getInstance } = useEditor((root) => {\n     const newEditor = Editor.make()\n-    useConfig(newEditor,root)\n+    useConfig(newEditor, root)\n     usePlugins(newEditor)\n     return newEditor\n-  },[])\n-  useEffect(()=>{\n-console.log(filePath)\n-  },[filePath])\n+  }, [])\n+  useEffect(() => {\n+    console.log(filePath)\n+  }, [filePath])\n   // 这个组件更新内容不会随着prop变化，需要手动设置\n   useEffect(() => {\n     if (!loading) {\n       const instance = getInstance()\n       instance?.action(replaceAll(content))\n       useUpdateHeaders()\n-\n       instance?.action((ctx) => {\n         ctx.get(themeManagerCtx).switch(ctx, nordDark)\n       })\n     }\n"
                },
                {
                    "date": 1666082217856,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -14,16 +14,17 @@\n   filePath: string\n }\n \n export const MilkdownEditor: React.FC<MilkdownEditor> = ({ content, filePath }) => {\n-  console.log('MilkdownEditor-update')\n   // 组件更新时，useEditor不会被重新调用\n   const { editor, loading, getInstance } = useEditor((root) => {\n+  console.log('MilkdownEditor-update')\n+\n     const newEditor = Editor.make()\n     useConfig(newEditor, root)\n     usePlugins(newEditor)\n     return newEditor\n-  }, [])\n+  }, [content])\n   useEffect(() => {\n     console.log(filePath)\n   }, [filePath])\n   // 这个组件更新内容不会随着prop变化，需要手动设置\n"
                },
                {
                    "date": 1666082272144,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -14,12 +14,11 @@\n   filePath: string\n }\n \n export const MilkdownEditor: React.FC<MilkdownEditor> = ({ content, filePath }) => {\n+  console.log('MilkdownEditor-update')\n   // 组件更新时，useEditor不会被重新调用\n   const { editor, loading, getInstance } = useEditor((root) => {\n-  console.log('MilkdownEditor-update')\n-\n     const newEditor = Editor.make()\n     useConfig(newEditor, root)\n     usePlugins(newEditor)\n     return newEditor\n"
                },
                {
                    "date": 1666082397999,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -17,13 +17,14 @@\n export const MilkdownEditor: React.FC<MilkdownEditor> = ({ content, filePath }) => {\n   console.log('MilkdownEditor-update')\n   // 组件更新时，useEditor不会被重新调用\n   const { editor, loading, getInstance } = useEditor((root) => {\n+    console.log('usesssss')\n     const newEditor = Editor.make()\n     useConfig(newEditor, root)\n     usePlugins(newEditor)\n     return newEditor\n-  }, [content])\n+  })\n   useEffect(() => {\n     console.log(filePath)\n   }, [filePath])\n   // 这个组件更新内容不会随着prop变化，需要手动设置\n"
                },
                {
                    "date": 1666082429330,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -17,9 +17,8 @@\n export const MilkdownEditor: React.FC<MilkdownEditor> = ({ content, filePath }) => {\n   console.log('MilkdownEditor-update')\n   // 组件更新时，useEditor不会被重新调用\n   const { editor, loading, getInstance } = useEditor((root) => {\n-    console.log('usesssss')\n     const newEditor = Editor.make()\n     useConfig(newEditor, root)\n     usePlugins(newEditor)\n     return newEditor\n"
                },
                {
                    "date": 1666083089012,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -7,8 +7,9 @@\n import { replaceAll } from '@milkdown/utils'\n import { nordDark } from '@milkdown/theme-nord'\n import { useConfig } from './hooks/useConfig'\n import { useUpdateHeaders } from '../SideBar/hooks/useUpdateHeader'\n+import { listenerCtx } from '@milkdown/plugin-listener'\n \n interface MilkdownEditor {\n   content: string\n   filePath: string\n@@ -31,8 +32,34 @@\n     if (!loading) {\n       const instance = getInstance()\n       instance?.action(replaceAll(content))\n       useUpdateHeaders()\n+instance?.config((ctx) => {\n+  ctx.get(listenerCtx)\n+    .beforeMount(() => {\n+      console.log('before the editor mounts')\n+    })\n+    .mounted(() => {\n+      console.log('after the editor mounts')\n+    })\n+    .updated(() => {\n+      console.log('when editor state updates')\n+    })\n+    // 点击文件列表后会两次调用，导致第一次渲染标题的时候还是旧的\n+    .markdownUpdated(() => {\n+      console.log('when markdown updates')\n+    })\n+    .blur(() => {\n+      console.log('blur editor')\n+    //   window.api.updateFile({ filePath, newFileContent:content })\n+    })\n+    .focus(() => {\n+      console.log(' when focus editor')\n+    })\n+    .destroy(() => {\n+      console.log('when editor is being destroyed')\n+    })\n+})\n       instance?.action((ctx) => {\n         ctx.get(themeManagerCtx).switch(ctx, nordDark)\n       })\n     }\n"
                },
                {
                    "date": 1666083263871,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -25,8 +25,11 @@\n     return newEditor\n   })\n   useEffect(() => {\n     console.log(filePath)\n+    document.addEventListener('input',()=>{\n+      console.log('xx')\n+    })\n   }, [filePath])\n   // 这个组件更新内容不会随着prop变化，需要手动设置\n   useEffect(() => {\n     if (!loading) {\n"
                },
                {
                    "date": 1666083890043,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -25,9 +25,9 @@\n     return newEditor\n   })\n   useEffect(() => {\n     console.log(filePath)\n-    document.addEventListener('input',()=>{\n+    document.addEventListener('input', () => {\n       console.log('xx')\n     })\n   }, [filePath])\n   // 这个组件更新内容不会随着prop变化，需要手动设置\n@@ -35,34 +35,8 @@\n     if (!loading) {\n       const instance = getInstance()\n       instance?.action(replaceAll(content))\n       useUpdateHeaders()\n-instance?.config((ctx) => {\n-  ctx.get(listenerCtx)\n-    .beforeMount(() => {\n-      console.log('before the editor mounts')\n-    })\n-    .mounted(() => {\n-      console.log('after the editor mounts')\n-    })\n-    .updated(() => {\n-      console.log('when editor state updates')\n-    })\n-    // 点击文件列表后会两次调用，导致第一次渲染标题的时候还是旧的\n-    .markdownUpdated(() => {\n-      console.log('when markdown updates')\n-    })\n-    .blur(() => {\n-      console.log('blur editor')\n-    //   window.api.updateFile({ filePath, newFileContent:content })\n-    })\n-    .focus(() => {\n-      console.log(' when focus editor')\n-    })\n-    .destroy(() => {\n-      console.log('when editor is being destroyed')\n-    })\n-})\n       instance?.action((ctx) => {\n         ctx.get(themeManagerCtx).switch(ctx, nordDark)\n       })\n     }\n"
                },
                {
                    "date": 1666084023041,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -25,11 +25,8 @@\n     return newEditor\n   })\n   useEffect(() => {\n     console.log(filePath)\n-    document.addEventListener('input', () => {\n-      console.log('xx')\n-    })\n   }, [filePath])\n   // 这个组件更新内容不会随着prop变化，需要手动设置\n   useEffect(() => {\n     if (!loading) {\n"
                },
                {
                    "date": 1666084094663,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -33,9 +33,9 @@\n       const instance = getInstance()\n       instance?.action(replaceAll(content))\n       useUpdateHeaders()\n       instance?.action((ctx) => {\n-        ctx.get(themeManagerCtx).switch(ctx, nordDark)\n+        // ctx.get(themeManagerCtx).switch(ctx, nordDark)\n       })\n     }\n   }, [loading, content])\n   return <ReactEditor editor={editor} />\n"
                },
                {
                    "date": 1666084393919,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -7,9 +7,8 @@\n import { replaceAll } from '@milkdown/utils'\n import { nordDark } from '@milkdown/theme-nord'\n import { useConfig } from './hooks/useConfig'\n import { useUpdateHeaders } from '../SideBar/hooks/useUpdateHeader'\n-import { listenerCtx } from '@milkdown/plugin-listener'\n \n interface MilkdownEditor {\n   content: string\n   filePath: string\n@@ -33,9 +32,9 @@\n       const instance = getInstance()\n       instance?.action(replaceAll(content))\n       useUpdateHeaders()\n       instance?.action((ctx) => {\n-        // ctx.get(themeManagerCtx).switch(ctx, nordDark)\n+        ctx.get(themeManagerCtx).switch(ctx, nordDark)\n       })\n     }\n   }, [loading, content])\n   return <ReactEditor editor={editor} />\n"
                },
                {
                    "date": 1666105778218,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,20 +3,22 @@\n \n import { ReactEditor, useEditor } from '@milkdown/react'\n import { usePlugins } from './hooks/usePlugins'\n import { themeManagerCtx } from '@milkdown/core'\n-import { replaceAll } from '@milkdown/utils'\n+import { replaceAll,getMarkdown } from '@milkdown/utils'\n import { nordDark } from '@milkdown/theme-nord'\n import { useConfig } from './hooks/useConfig'\n import { useUpdateHeaders } from '../SideBar/hooks/useUpdateHeader'\n+import { useMarkdown } from './hooks/useMarkdown'\n \n interface MilkdownEditor {\n   content: string\n   filePath: string\n }\n \n export const MilkdownEditor: React.FC<MilkdownEditor> = ({ content, filePath }) => {\n   console.log('MilkdownEditor-update')\n+\n   // 组件更新时，useEditor不会被重新调用\n   const { editor, loading, getInstance } = useEditor((root) => {\n     const newEditor = Editor.make()\n     useConfig(newEditor, root)\n"
                },
                {
                    "date": 1666106032799,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -7,9 +7,8 @@\n import { replaceAll,getMarkdown } from '@milkdown/utils'\n import { nordDark } from '@milkdown/theme-nord'\n import { useConfig } from './hooks/useConfig'\n import { useUpdateHeaders } from '../SideBar/hooks/useUpdateHeader'\n-import { useMarkdown } from './hooks/useMarkdown'\n \n interface MilkdownEditor {\n   content: string\n   filePath: string\n@@ -32,8 +31,10 @@\n   useEffect(() => {\n     if (!loading) {\n       const instance = getInstance()\n       instance?.action(replaceAll(content))\n+      console.log(instance?.action(getMarkdown()))\n+      console.log(content)\n       useUpdateHeaders()\n       instance?.action((ctx) => {\n         ctx.get(themeManagerCtx).switch(ctx, nordDark)\n       })\n"
                },
                {
                    "date": 1666106097885,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -31,10 +31,9 @@\n   useEffect(() => {\n     if (!loading) {\n       const instance = getInstance()\n       instance?.action(replaceAll(content))\n-      console.log(instance?.action(getMarkdown()))\n-      console.log(content)\n+      console.log(instance?.action(getMarkdown()) === content)\n       useUpdateHeaders()\n       instance?.action((ctx) => {\n         ctx.get(themeManagerCtx).switch(ctx, nordDark)\n       })\n"
                },
                {
                    "date": 1666106325841,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -7,8 +7,9 @@\n import { replaceAll,getMarkdown } from '@milkdown/utils'\n import { nordDark } from '@milkdown/theme-nord'\n import { useConfig } from './hooks/useConfig'\n import { useUpdateHeaders } from '../SideBar/hooks/useUpdateHeader'\n+import { listenerCtx } from '@milkdown/plugin-listener'\n \n interface MilkdownEditor {\n   content: string\n   filePath: string\n@@ -31,9 +32,13 @@\n   useEffect(() => {\n     if (!loading) {\n       const instance = getInstance()\n       instance?.action(replaceAll(content))\n-      console.log(instance?.action(getMarkdown()) === content)\n+      instance?.action(ctx =>{\n+        ctx.get(listenerCtx).markdownUpdated(()=>{\n+          console.log('change')\n+        })\n+      })\n       useUpdateHeaders()\n       instance?.action((ctx) => {\n         ctx.get(themeManagerCtx).switch(ctx, nordDark)\n       })\n"
                },
                {
                    "date": 1666106344927,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -34,9 +34,9 @@\n       const instance = getInstance()\n       instance?.action(replaceAll(content))\n       instance?.action(ctx =>{\n         ctx.get(listenerCtx).markdownUpdated(()=>{\n-          console.log('change')\n+          console.log('changexxxxxxxxxxxxxxxxxxx')\n         })\n       })\n       useUpdateHeaders()\n       instance?.action((ctx) => {\n"
                },
                {
                    "date": 1666106520679,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -39,9 +39,9 @@\n         })\n       })\n       useUpdateHeaders()\n       instance?.action((ctx) => {\n-        ctx.get(themeManagerCtx).switch(ctx, nordDark)\n+        // ctx.get(themeManagerCtx).switch(ctx, nordDark)\n       })\n     }\n   }, [loading, content])\n   return <ReactEditor editor={editor} />\n"
                },
                {
                    "date": 1666106611189,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -39,9 +39,9 @@\n         })\n       })\n       useUpdateHeaders()\n       instance?.action((ctx) => {\n-        // ctx.get(themeManagerCtx).switch(ctx, nordDark)\n+        ctx.get(themeManagerCtx).switch(ctx, nordDark)\n       })\n     }\n   }, [loading, content])\n   return <ReactEditor editor={editor} />\n"
                },
                {
                    "date": 1666106767093,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,9 +3,9 @@\n \n import { ReactEditor, useEditor } from '@milkdown/react'\n import { usePlugins } from './hooks/usePlugins'\n import { themeManagerCtx } from '@milkdown/core'\n-import { replaceAll,getMarkdown } from '@milkdown/utils'\n+import { replaceAll, getMarkdown } from '@milkdown/utils'\n import { nordDark } from '@milkdown/theme-nord'\n import { useConfig } from './hooks/useConfig'\n import { useUpdateHeaders } from '../SideBar/hooks/useUpdateHeader'\n import { listenerCtx } from '@milkdown/plugin-listener'\n@@ -27,22 +27,26 @@\n   })\n   useEffect(() => {\n     console.log(filePath)\n   }, [filePath])\n+\n   // 这个组件更新内容不会随着prop变化，需要手动设置\n   useEffect(() => {\n     if (!loading) {\n       const instance = getInstance()\n       instance?.action(replaceAll(content))\n-      instance?.action(ctx =>{\n-        ctx.get(listenerCtx).markdownUpdated(()=>{\n-          console.log('changexxxxxxxxxxxxxxxxxxx')\n-        })\n-      })\n       useUpdateHeaders()\n       instance?.action((ctx) => {\n         ctx.get(themeManagerCtx).switch(ctx, nordDark)\n       })\n     }\n   }, [loading, content])\n+  useEffect(() => {\n+    const instance = getInstance()\n+    instance?.action((ctx) => {\n+      ctx.get(listenerCtx).markdownUpdated(() => {\n+        console.log('changexxxxxxxxxxxxxxxxxxx')\n+      })\n+    })\n+  }, [])\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1666106879952,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -17,9 +17,9 @@\n \n export const MilkdownEditor: React.FC<MilkdownEditor> = ({ content, filePath }) => {\n   console.log('MilkdownEditor-update')\n \n-  // 组件更新时，useEditor不会被重新调用\n+  // 组件更新时，useEditor不会被重新调用，可能是用了类似useCallback\n   const { editor, loading, getInstance } = useEditor((root) => {\n     const newEditor = Editor.make()\n     useConfig(newEditor, root)\n     usePlugins(newEditor)\n@@ -39,8 +39,9 @@\n         ctx.get(themeManagerCtx).switch(ctx, nordDark)\n       })\n     }\n   }, [loading, content])\n+  // 使用空数组，就算后面更新了也不会执行\n   useEffect(() => {\n     const instance = getInstance()\n     instance?.action((ctx) => {\n       ctx.get(listenerCtx).markdownUpdated(() => {\n"
                },
                {
                    "date": 1666106986797,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -45,8 +45,10 @@\n     const instance = getInstance()\n     instance?.action((ctx) => {\n       ctx.get(listenerCtx).markdownUpdated(() => {\n         console.log('changexxxxxxxxxxxxxxxxxxx')\n+      }).updated(()=>{\n+        console.log('up')\n       })\n     })\n   }, [])\n   return <ReactEditor editor={editor} />\n"
                },
                {
                    "date": 1666107004953,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -45,10 +45,8 @@\n     const instance = getInstance()\n     instance?.action((ctx) => {\n       ctx.get(listenerCtx).markdownUpdated(() => {\n         console.log('changexxxxxxxxxxxxxxxxxxx')\n-      }).updated(()=>{\n-        console.log('up')\n       })\n     })\n   }, [])\n   return <ReactEditor editor={editor} />\n"
                },
                {
                    "date": 1666107024976,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -45,8 +45,10 @@\n     const instance = getInstance()\n     instance?.action((ctx) => {\n       ctx.get(listenerCtx).markdownUpdated(() => {\n         console.log('changexxxxxxxxxxxxxxxxxxx')\n+      }).updated(()=>{\n+        console.log('up')\n       })\n     })\n   }, [])\n   return <ReactEditor editor={editor} />\n"
                },
                {
                    "date": 1666107154862,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -43,13 +43,16 @@\n   // 使用空数组，就算后面更新了也不会执行\n   useEffect(() => {\n     const instance = getInstance()\n     instance?.action((ctx) => {\n-      ctx.get(listenerCtx).markdownUpdated(() => {\n-        console.log('changexxxxxxxxxxxxxxxxxxx')\n-      }).updated(()=>{\n-        console.log('up')\n-      })\n+      ctx\n+        .get(listenerCtx)\n+        .markdownUpdated(() => {\n+          console.log('changexxxxxxxxxxxxxxxxxxx')\n+        })\n+        .updated(() => {\n+          console.log('up')\n+        })\n     })\n   }, [])\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1666107225888,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -52,7 +52,7 @@\n         .updated(() => {\n           console.log('up')\n         })\n     })\n-  }, [])\n+  }, [loading])\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1666107280520,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -52,7 +52,7 @@\n         .updated(() => {\n           console.log('up')\n         })\n     })\n-  }, [loading])\n+  }, [])\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1666107491348,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -28,11 +28,11 @@\n   useEffect(() => {\n     console.log(filePath)\n   }, [filePath])\n \n-  // 这个组件更新内容不会随着prop变化，需要手动设置\n   useEffect(() => {\n     if (!loading) {\n+      console.log('xxxx')\n       const instance = getInstance()\n       instance?.action(replaceAll(content))\n       useUpdateHeaders()\n       instance?.action((ctx) => {\n"
                },
                {
                    "date": 1666107610419,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -52,7 +52,7 @@\n         .updated(() => {\n           console.log('up')\n         })\n     })\n-  }, [])\n+  }, [loading])\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1666107625212,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -30,9 +30,8 @@\n   }, [filePath])\n \n   useEffect(() => {\n     if (!loading) {\n-      console.log('xxxx')\n       const instance = getInstance()\n       instance?.action(replaceAll(content))\n       useUpdateHeaders()\n       instance?.action((ctx) => {\n"
                },
                {
                    "date": 1666107653074,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -47,11 +47,8 @@\n         .get(listenerCtx)\n         .markdownUpdated(() => {\n           console.log('changexxxxxxxxxxxxxxxxxxx')\n         })\n-        .updated(() => {\n-          console.log('up')\n-        })\n     })\n   }, [loading])\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1666107703020,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -40,15 +40,18 @@\n     }\n   }, [loading, content])\n   // 使用空数组，就算后面更新了也不会执行\n   useEffect(() => {\n-    const instance = getInstance()\n-    instance?.action((ctx) => {\n-      ctx\n-        .get(listenerCtx)\n-        .markdownUpdated(() => {\n-          console.log('changexxxxxxxxxxxxxxxxxxx')\n-        })\n-    })\n+    if(!loading) {\n+      const instance = getInstance()\n+      instance?.action((ctx) => {\n+        ctx\n+          .get(listenerCtx)\n+          .markdownUpdated(() => {\n+            console.log('changexxxxxxxxxxxxxxxxxxx')\n+          })\n+      })\n+    }\n+\n   }, [loading])\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1666107756230,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -51,7 +51,7 @@\n           })\n       })\n     }\n \n-  }, [loading])\n+  }, [])\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1666107774001,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -42,8 +42,9 @@\n   // 使用空数组，就算后面更新了也不会执行\n   useEffect(() => {\n     if(!loading) {\n       const instance = getInstance()\n+      console.log(instance)\n       instance?.action((ctx) => {\n         ctx\n           .get(listenerCtx)\n           .markdownUpdated(() => {\n"
                },
                {
                    "date": 1666107793886,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -40,11 +40,12 @@\n     }\n   }, [loading, content])\n   // 使用空数组，就算后面更新了也不会执行\n   useEffect(() => {\n+    const instance = getInstance()\n+    console.log(instance)\n+\n     if(!loading) {\n-      const instance = getInstance()\n-      console.log(instance)\n       instance?.action((ctx) => {\n         ctx\n           .get(listenerCtx)\n           .markdownUpdated(() => {\n"
                },
                {
                    "date": 1666107902461,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -40,12 +40,10 @@\n     }\n   }, [loading, content])\n   // 使用空数组，就算后面更新了也不会执行\n   useEffect(() => {\n+    if(!loading) {\n     const instance = getInstance()\n-    console.log(instance)\n-\n-    if(!loading) {\n       instance?.action((ctx) => {\n         ctx\n           .get(listenerCtx)\n           .markdownUpdated(() => {\n@@ -53,7 +51,7 @@\n           })\n       })\n     }\n \n-  }, [])\n+  }, [loading])\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1666107939335,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -40,18 +40,15 @@\n     }\n   }, [loading, content])\n   // 使用空数组，就算后面更新了也不会执行\n   useEffect(() => {\n-    if(!loading) {\n-    const instance = getInstance()\n+    if (!loading) {\n+      const instance = getInstance()\n       instance?.action((ctx) => {\n-        ctx\n-          .get(listenerCtx)\n-          .markdownUpdated(() => {\n-            console.log('changexxxxxxxxxxxxxxxxxxx')\n-          })\n+        ctx.get(listenerCtx).markdownUpdated((ctx,markdown,preMarkdown) =>{\n+          console.log(markdown===preMarkdown)\n+        })\n       })\n     }\n-\n   }, [loading])\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1666107979826,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -44,8 +44,10 @@\n     if (!loading) {\n       const instance = getInstance()\n       instance?.action((ctx) => {\n         ctx.get(listenerCtx).markdownUpdated((ctx,markdown,preMarkdown) =>{\n+          console.log(markdown)\n+          console.log(preMarkdown)\n           console.log(markdown===preMarkdown)\n         })\n       })\n     }\n"
                },
                {
                    "date": 1666108015189,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -44,10 +44,9 @@\n     if (!loading) {\n       const instance = getInstance()\n       instance?.action((ctx) => {\n         ctx.get(listenerCtx).markdownUpdated((ctx,markdown,preMarkdown) =>{\n-          console.log(markdown)\n-          console.log(preMarkdown)\n+          if(!preMarkdown) preMarkdown = markdown\n           console.log(markdown===preMarkdown)\n         })\n       })\n     }\n"
                },
                {
                    "date": 1666108099692,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -32,8 +32,14 @@\n   useEffect(() => {\n     if (!loading) {\n       const instance = getInstance()\n       instance?.action(replaceAll(content))\n+      instance?.action((ctx) => {\n+        ctx.get(listenerCtx).markdownUpdated((ctx,markdown,preMarkdown) =>{\n+          if(!preMarkdown) preMarkdown = markdown\n+          console.log(markdown===preMarkdown)\n+        })\n+      })\n       useUpdateHeaders()\n       instance?.action((ctx) => {\n         ctx.get(themeManagerCtx).switch(ctx, nordDark)\n       })\n@@ -42,14 +48,9 @@\n   // 使用空数组，就算后面更新了也不会执行\n   useEffect(() => {\n     if (!loading) {\n       const instance = getInstance()\n-      instance?.action((ctx) => {\n-        ctx.get(listenerCtx).markdownUpdated((ctx,markdown,preMarkdown) =>{\n-          if(!preMarkdown) preMarkdown = markdown\n-          console.log(markdown===preMarkdown)\n-        })\n-      })\n+\n     }\n   }, [loading])\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1666108148248,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -32,14 +32,8 @@\n   useEffect(() => {\n     if (!loading) {\n       const instance = getInstance()\n       instance?.action(replaceAll(content))\n-      instance?.action((ctx) => {\n-        ctx.get(listenerCtx).markdownUpdated((ctx,markdown,preMarkdown) =>{\n-          if(!preMarkdown) preMarkdown = markdown\n-          console.log(markdown===preMarkdown)\n-        })\n-      })\n       useUpdateHeaders()\n       instance?.action((ctx) => {\n         ctx.get(themeManagerCtx).switch(ctx, nordDark)\n       })\n@@ -48,9 +42,14 @@\n   // 使用空数组，就算后面更新了也不会执行\n   useEffect(() => {\n     if (!loading) {\n       const instance = getInstance()\n-\n+      instance?.action((ctx) => {\n+        ctx.get(listenerCtx).markdownUpdated((ctx,markdown,preMarkdown) =>{\n+          if(!preMarkdown) preMarkdown = markdown\n+          console.log(markdown===preMarkdown)\n+        })\n+      })\n     }\n   }, [loading])\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1666108168208,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -49,7 +49,7 @@\n           console.log(markdown===preMarkdown)\n         })\n       })\n     }\n-  }, [loading])\n+  }, [getInstance()])\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1666108201542,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -40,8 +40,9 @@\n     }\n   }, [loading, content])\n   // 使用空数组，就算后面更新了也不会执行\n   useEffect(() => {\n+    console.log('instance change')\n     if (!loading) {\n       const instance = getInstance()\n       instance?.action((ctx) => {\n         ctx.get(listenerCtx).markdownUpdated((ctx,markdown,preMarkdown) =>{\n"
                },
                {
                    "date": 1666108264159,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -46,9 +46,10 @@\n       const instance = getInstance()\n       instance?.action((ctx) => {\n         ctx.get(listenerCtx).markdownUpdated((ctx,markdown,preMarkdown) =>{\n           if(!preMarkdown) preMarkdown = markdown\n-          console.log(markdown===preMarkdown)\n+          console.log(markdown)\n+          console.log(preMarkdown)\n         })\n       })\n     }\n   }, [getInstance()])\n"
                },
                {
                    "date": 1666108395689,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -45,11 +45,9 @@\n     if (!loading) {\n       const instance = getInstance()\n       instance?.action((ctx) => {\n         ctx.get(listenerCtx).markdownUpdated((ctx,markdown,preMarkdown) =>{\n-          if(!preMarkdown) preMarkdown = markdown\n           console.log(markdown)\n-          console.log(preMarkdown)\n         })\n       })\n     }\n   }, [getInstance()])\n"
                },
                {
                    "date": 1666108485772,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -49,7 +49,7 @@\n           console.log(markdown)\n         })\n       })\n     }\n-  }, [getInstance()])\n+  }, [loading])\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1666108575845,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -40,14 +40,13 @@\n     }\n   }, [loading, content])\n   // 使用空数组，就算后面更新了也不会执行\n   useEffect(() => {\n-    console.log('instance change')\n     if (!loading) {\n       const instance = getInstance()\n       instance?.action((ctx) => {\n         ctx.get(listenerCtx).markdownUpdated((ctx,markdown,preMarkdown) =>{\n-          console.log(markdown)\n+          console.log('changexxxxx')\n         })\n       })\n     }\n   }, [loading])\n"
                },
                {
                    "date": 1666108603521,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -48,7 +48,7 @@\n           console.log('changexxxxx')\n         })\n       })\n     }\n-  }, [loading])\n+  })\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1666108622355,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -48,7 +48,7 @@\n           console.log('changexxxxx')\n         })\n       })\n     }\n-  })\n+  },[])\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1666108732423,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -42,9 +42,9 @@\n   // 使用空数组，就算后面更新了也不会执行\n   useEffect(() => {\n     if (!loading) {\n       const instance = getInstance()\n-      instance?.action((ctx) => {\n+      instance!.action((ctx) => {\n         ctx.get(listenerCtx).markdownUpdated((ctx,markdown,preMarkdown) =>{\n           console.log('changexxxxx')\n         })\n       })\n"
                },
                {
                    "date": 1666108740956,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -40,15 +40,14 @@\n     }\n   }, [loading, content])\n   // 使用空数组，就算后面更新了也不会执行\n   useEffect(() => {\n-    if (!loading) {\n       const instance = getInstance()\n       instance!.action((ctx) => {\n         ctx.get(listenerCtx).markdownUpdated((ctx,markdown,preMarkdown) =>{\n           console.log('changexxxxx')\n         })\n       })\n-    }\n+\n   },[])\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1666108757038,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -15,9 +15,8 @@\n   filePath: string\n }\n \n export const MilkdownEditor: React.FC<MilkdownEditor> = ({ content, filePath }) => {\n-  console.log('MilkdownEditor-update')\n \n   // 组件更新时，useEditor不会被重新调用，可能是用了类似useCallback\n   const { editor, loading, getInstance } = useEditor((root) => {\n     const newEditor = Editor.make()\n"
                },
                {
                    "date": 1666108814028,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -20,8 +20,13 @@\n   // 组件更新时，useEditor不会被重新调用，可能是用了类似useCallback\n   const { editor, loading, getInstance } = useEditor((root) => {\n     const newEditor = Editor.make()\n     useConfig(newEditor, root)\n+    newEditor!.action((ctx) => {\n+      ctx.get(listenerCtx).markdownUpdated((ctx,markdown,preMarkdown) =>{\n+        console.log('changexxxxx')\n+      })\n+    })\n     usePlugins(newEditor)\n     return newEditor\n   })\n   useEffect(() => {\n@@ -39,14 +44,14 @@\n     }\n   }, [loading, content])\n   // 使用空数组，就算后面更新了也不会执行\n   useEffect(() => {\n-      const instance = getInstance()\n-      instance!.action((ctx) => {\n-        ctx.get(listenerCtx).markdownUpdated((ctx,markdown,preMarkdown) =>{\n-          console.log('changexxxxx')\n-        })\n-      })\n+      // const instance = getInstance()\n+      // instance!.action((ctx) => {\n+      //   ctx.get(listenerCtx).markdownUpdated((ctx,markdown,preMarkdown) =>{\n+      //     console.log('changexxxxx')\n+      //   })\n+      // })\n \n   },[])\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1666108834605,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -20,13 +20,9 @@\n   // 组件更新时，useEditor不会被重新调用，可能是用了类似useCallback\n   const { editor, loading, getInstance } = useEditor((root) => {\n     const newEditor = Editor.make()\n     useConfig(newEditor, root)\n-    newEditor!.action((ctx) => {\n-      ctx.get(listenerCtx).markdownUpdated((ctx,markdown,preMarkdown) =>{\n-        console.log('changexxxxx')\n-      })\n-    })\n+    \n     usePlugins(newEditor)\n     return newEditor\n   })\n   useEffect(() => {\n"
                },
                {
                    "date": 1666108883409,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -40,14 +40,14 @@\n     }\n   }, [loading, content])\n   // 使用空数组，就算后面更新了也不会执行\n   useEffect(() => {\n-      // const instance = getInstance()\n-      // instance!.action((ctx) => {\n-      //   ctx.get(listenerCtx).markdownUpdated((ctx,markdown,preMarkdown) =>{\n-      //     console.log('changexxxxx')\n-      //   })\n-      // })\n+      const instance = getInstance()\n+      instance?.action((ctx) => {\n+        ctx.get(listenerCtx).markdownUpdated((ctx,markdown,preMarkdown) =>{\n+          console.log('changexxxxx')\n+        })\n+      })\n \n-  },[])\n+  },[loading])\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1666141864927,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -39,15 +39,15 @@\n       })\n     }\n   }, [loading, content])\n   // 使用空数组，就算后面更新了也不会执行\n-  useEffect(() => {\n-      const instance = getInstance()\n-      instance?.action((ctx) => {\n-        ctx.get(listenerCtx).markdownUpdated((ctx,markdown,preMarkdown) =>{\n-          console.log('changexxxxx')\n-        })\n-      })\n+  // useEffect(() => {\n+  //     const instance = getInstance()\n+  //     instance?.action((ctx) => {\n+  //       ctx.get(listenerCtx).markdownUpdated((ctx,markdown,preMarkdown) =>{\n+  //         console.log('changexxxxx')\n+  //       })\n+  //     })\n \n-  },[loading])\n+  // },[loading])\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1666142059255,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -36,9 +36,18 @@\n       useUpdateHeaders()\n       instance?.action((ctx) => {\n         ctx.get(themeManagerCtx).switch(ctx, nordDark)\n       })\n+      document.addEventListener('input',()=>{\n+        console.log('input')\n+      })\n+      document.addEventListener('paste',()=>{\n+        console.log('past')\n+      })\n     }\n+    return ()=>{\n+\n+    }\n   }, [loading, content])\n   // 使用空数组，就算后面更新了也不会执行\n   // useEffect(() => {\n   //     const instance = getInstance()\n"
                },
                {
                    "date": 1666142225585,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -36,17 +36,11 @@\n       useUpdateHeaders()\n       instance?.action((ctx) => {\n         ctx.get(themeManagerCtx).switch(ctx, nordDark)\n       })\n-      document.addEventListener('input',()=>{\n-        console.log('input')\n-      })\n-      document.addEventListener('paste',()=>{\n-        console.log('past')\n-      })\n     }\n     return ()=>{\n-\n+      console.log('组件卸载了')\n     }\n   }, [loading, content])\n   // 使用空数组，就算后面更新了也不会执行\n   // useEffect(() => {\n"
                },
                {
                    "date": 1666142304474,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -26,8 +26,11 @@\n     return newEditor\n   })\n   useEffect(() => {\n     console.log(filePath)\n+    return ()=>{\n+      console.log('组件卸载了')\n+    }\n   }, [filePath])\n \n   useEffect(() => {\n     if (!loading) {\n@@ -38,9 +41,9 @@\n         ctx.get(themeManagerCtx).switch(ctx, nordDark)\n       })\n     }\n     return ()=>{\n-      console.log('组件卸载了')\n+      \n     }\n   }, [loading, content])\n   // 使用空数组，就算后面更新了也不会执行\n   // useEffect(() => {\n"
                },
                {
                    "date": 1666142477127,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -20,9 +20,8 @@\n   // 组件更新时，useEditor不会被重新调用，可能是用了类似useCallback\n   const { editor, loading, getInstance } = useEditor((root) => {\n     const newEditor = Editor.make()\n     useConfig(newEditor, root)\n-    \n     usePlugins(newEditor)\n     return newEditor\n   })\n   useEffect(() => {\n"
                },
                {
                    "date": 1666142601131,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,6 +1,6 @@\n import React, { useEffect } from 'react'\n-import { Editor } from '@milkdown/core'\n+import { Editor, editorStateCtx } from '@milkdown/core'\n \n import { ReactEditor, useEditor } from '@milkdown/react'\n import { usePlugins } from './hooks/usePlugins'\n import { themeManagerCtx } from '@milkdown/core'\n@@ -15,9 +15,8 @@\n   filePath: string\n }\n \n export const MilkdownEditor: React.FC<MilkdownEditor> = ({ content, filePath }) => {\n-\n   // 组件更新时，useEditor不会被重新调用，可能是用了类似useCallback\n   const { editor, loading, getInstance } = useEditor((root) => {\n     const newEditor = Editor.make()\n     useConfig(newEditor, root)\n@@ -25,10 +24,10 @@\n     return newEditor\n   })\n   useEffect(() => {\n     console.log(filePath)\n-    return ()=>{\n-      console.log('组件卸载了')\n+    return () => {\n+      const newMarkdown = console.log('组件卸载了')\n     }\n   }, [filePath])\n \n   useEffect(() => {\n@@ -37,13 +36,16 @@\n       instance?.action(replaceAll(content))\n       useUpdateHeaders()\n       instance?.action((ctx) => {\n         ctx.get(themeManagerCtx).switch(ctx, nordDark)\n+        const state = ctx.get(editorStateCtx)\n+\n+        const { doc, schema } = state\n+        console.log(doc)\n+        console.log(schema)\n       })\n     }\n-    return ()=>{\n-      \n-    }\n+    return () => {}\n   }, [loading, content])\n   // 使用空数组，就算后面更新了也不会执行\n   // useEffect(() => {\n   //     const instance = getInstance()\n"
                },
                {
                    "date": 1666142811972,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,5 +1,5 @@\n-import React, { useEffect } from 'react'\n+import React, { useEffect, useState } from 'react'\n import { Editor, editorStateCtx } from '@milkdown/core'\n \n import { ReactEditor, useEditor } from '@milkdown/react'\n import { usePlugins } from './hooks/usePlugins'\n@@ -15,8 +15,9 @@\n   filePath: string\n }\n \n export const MilkdownEditor: React.FC<MilkdownEditor> = ({ content, filePath }) => {\n+  const [m,setM] = useState('')\n   // 组件更新时，useEditor不会被重新调用，可能是用了类似useCallback\n   const { editor, loading, getInstance } = useEditor((root) => {\n     const newEditor = Editor.make()\n     useConfig(newEditor, root)\n@@ -36,14 +37,11 @@\n       instance?.action(replaceAll(content))\n       useUpdateHeaders()\n       instance?.action((ctx) => {\n         ctx.get(themeManagerCtx).switch(ctx, nordDark)\n-        const state = ctx.get(editorStateCtx)\n-\n-        const { doc, schema } = state\n-        console.log(doc)\n-        console.log(schema)\n       })\n+      const markdown = instance?.action(getMarkdown())\n+      setM(markdown)\n     }\n     return () => {}\n   }, [loading, content])\n   // 使用空数组，就算后面更新了也不会执行\n"
                },
                {
                    "date": 1666142838477,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -26,9 +26,11 @@\n   })\n   useEffect(() => {\n     console.log(filePath)\n     return () => {\n-      const newMarkdown = console.log('组件卸载了')\n+      const instance = getInstance()\n+      const newMarkdown = instance?.action(getMarkdown())\n+      console.log(newMarkdown===m)\n     }\n   }, [filePath])\n \n   useEffect(() => {\n"
                },
                {
                    "date": 1666142886103,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -40,9 +40,9 @@\n       useUpdateHeaders()\n       instance?.action((ctx) => {\n         ctx.get(themeManagerCtx).switch(ctx, nordDark)\n       })\n-      const markdown = instance?.action(getMarkdown())\n+      const markdown = instance?.action(getMarkdown()) as string\n       setM(markdown)\n     }\n     return () => {}\n   }, [loading, content])\n"
                },
                {
                    "date": 1666142926296,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -28,9 +28,11 @@\n     console.log(filePath)\n     return () => {\n       const instance = getInstance()\n       const newMarkdown = instance?.action(getMarkdown())\n-      console.log(newMarkdown===m)\n+      console.log(newMarkdown)\n+      console.log(m)\n+      // console.log(newMarkdown===m)\n     }\n   }, [filePath])\n \n   useEffect(() => {\n"
                },
                {
                    "date": 1666143149877,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -26,13 +26,8 @@\n   })\n   useEffect(() => {\n     console.log(filePath)\n     return () => {\n-      const instance = getInstance()\n-      const newMarkdown = instance?.action(getMarkdown())\n-      console.log(newMarkdown)\n-      console.log(m)\n-      // console.log(newMarkdown===m)\n     }\n   }, [filePath])\n \n   useEffect(() => {\n@@ -42,10 +37,8 @@\n       useUpdateHeaders()\n       instance?.action((ctx) => {\n         ctx.get(themeManagerCtx).switch(ctx, nordDark)\n       })\n-      const markdown = instance?.action(getMarkdown()) as string\n-      setM(markdown)\n     }\n     return () => {}\n   }, [loading, content])\n   // 使用空数组，就算后面更新了也不会执行\n"
                },
                {
                    "date": 1666143519058,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -37,8 +37,13 @@\n       useUpdateHeaders()\n       instance?.action((ctx) => {\n         ctx.get(themeManagerCtx).switch(ctx, nordDark)\n       })\n+      instance?.action(ctx=>{\n+        ctx.get(listenerCtx).markdownUpdated((ctx,markdown) =>{\n+          console.log(markdown)\n+        })\n+      })\n     }\n     return () => {}\n   }, [loading, content])\n   // 使用空数组，就算后面更新了也不会执行\n"
                },
                {
                    "date": 1666143600802,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -28,22 +28,26 @@\n     console.log(filePath)\n     return () => {\n     }\n   }, [filePath])\n+  useEffect(()=>{\n+    const instance = getInstance()\n \n+    instance?.action(ctx=>{\n+      ctx.get(listenerCtx).markdownUpdated((ctx,markdown) =>{\n+        console.log(markdown)\n+      })\n+    })\n+  },[loading])\n   useEffect(() => {\n     if (!loading) {\n       const instance = getInstance()\n       instance?.action(replaceAll(content))\n       useUpdateHeaders()\n       instance?.action((ctx) => {\n         ctx.get(themeManagerCtx).switch(ctx, nordDark)\n       })\n-      instance?.action(ctx=>{\n-        ctx.get(listenerCtx).markdownUpdated((ctx,markdown) =>{\n-          console.log(markdown)\n-        })\n-      })\n+\n     }\n     return () => {}\n   }, [loading, content])\n   // 使用空数组，就算后面更新了也不会执行\n"
                },
                {
                    "date": 1666143651949,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -15,9 +15,9 @@\n   filePath: string\n }\n \n export const MilkdownEditor: React.FC<MilkdownEditor> = ({ content, filePath }) => {\n-  const [m,setM] = useState('')\n+  const [m, setM] = useState('')\n   // 组件更新时，useEditor不会被重新调用，可能是用了类似useCallback\n   const { editor, loading, getInstance } = useEditor((root) => {\n     const newEditor = Editor.make()\n     useConfig(newEditor, root)\n@@ -25,29 +25,27 @@\n     return newEditor\n   })\n   useEffect(() => {\n     console.log(filePath)\n-    return () => {\n-    }\n+    return () => {}\n   }, [filePath])\n-  useEffect(()=>{\n+  useEffect(() => {\n     const instance = getInstance()\n \n-    instance?.action(ctx=>{\n-      ctx.get(listenerCtx).markdownUpdated((ctx,markdown) =>{\n+    instance?.action((ctx) => {\n+      ctx.get(listenerCtx).markdownUpdated((ctx, markdown) => {\n         console.log(markdown)\n       })\n     })\n-  },[loading])\n+  }, [loading])\n   useEffect(() => {\n     if (!loading) {\n       const instance = getInstance()\n       instance?.action(replaceAll(content))\n       useUpdateHeaders()\n       instance?.action((ctx) => {\n         ctx.get(themeManagerCtx).switch(ctx, nordDark)\n       })\n-\n     }\n     return () => {}\n   }, [loading, content])\n   // 使用空数组，就算后面更新了也不会执行\n"
                },
                {
                    "date": 1666143704038,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -35,9 +35,9 @@\n       ctx.get(listenerCtx).markdownUpdated((ctx, markdown) => {\n         console.log(markdown)\n       })\n     })\n-  }, [loading])\n+  }, [])\n   useEffect(() => {\n     if (!loading) {\n       const instance = getInstance()\n       instance?.action(replaceAll(content))\n"
                },
                {
                    "date": 1666143805478,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -29,11 +29,11 @@\n     return () => {}\n   }, [filePath])\n   useEffect(() => {\n     const instance = getInstance()\n-\n     instance?.action((ctx) => {\n       ctx.get(listenerCtx).markdownUpdated((ctx, markdown) => {\n+        if(!loading)\n         console.log(markdown)\n       })\n     })\n   }, [])\n"
                },
                {
                    "date": 1666143854046,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -31,9 +31,8 @@\n   useEffect(() => {\n     const instance = getInstance()\n     instance?.action((ctx) => {\n       ctx.get(listenerCtx).markdownUpdated((ctx, markdown) => {\n-        if(!loading)\n         console.log(markdown)\n       })\n     })\n   }, [])\n"
                },
                {
                    "date": 1666143932417,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -32,8 +32,9 @@\n     const instance = getInstance()\n     instance?.action((ctx) => {\n       ctx.get(listenerCtx).markdownUpdated((ctx, markdown) => {\n         console.log(markdown)\n+        console.log(instance.action(getMarkdown())\n       })\n     })\n   }, [])\n   useEffect(() => {\n"
                },
                {
                    "date": 1666143940392,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -32,9 +32,9 @@\n     const instance = getInstance()\n     instance?.action((ctx) => {\n       ctx.get(listenerCtx).markdownUpdated((ctx, markdown) => {\n         console.log(markdown)\n-        console.log(instance.action(getMarkdown())\n+        console.log(instance.action(getMarkdown()))\n       })\n     })\n   }, [])\n   useEffect(() => {\n"
                },
                {
                    "date": 1666143978518,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -28,17 +28,8 @@\n     console.log(filePath)\n     return () => {}\n   }, [filePath])\n   useEffect(() => {\n-    const instance = getInstance()\n-    instance?.action((ctx) => {\n-      ctx.get(listenerCtx).markdownUpdated((ctx, markdown) => {\n-        console.log(markdown)\n-        console.log(instance.action(getMarkdown()))\n-      })\n-    })\n-  }, [])\n-  useEffect(() => {\n     if (!loading) {\n       const instance = getInstance()\n       instance?.action(replaceAll(content))\n       useUpdateHeaders()\n@@ -47,8 +38,18 @@\n       })\n     }\n     return () => {}\n   }, [loading, content])\n+  useEffect(() => {\n+    const instance = getInstance()\n+    instance?.action((ctx) => {\n+      ctx.get(listenerCtx).markdownUpdated((ctx, markdown) => {\n+        console.log(markdown)\n+        console.log(instance.action(getMarkdown()))\n+      })\n+    })\n+  }, [])\n+\n   // 使用空数组，就算后面更新了也不会执行\n   // useEffect(() => {\n   //     const instance = getInstance()\n   //     instance?.action((ctx) => {\n"
                },
                {
                    "date": 1666144044526,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -43,11 +43,14 @@\n     const instance = getInstance()\n     instance?.action((ctx) => {\n       ctx.get(listenerCtx).markdownUpdated((ctx, markdown) => {\n         console.log(markdown)\n-        console.log(instance.action(getMarkdown()))\n       })\n     })\n+    return ()=>{\n+      console.log(instance.action(getMarkdown()))\n+\n+    }\n   }, [])\n \n   // 使用空数组，就算后面更新了也不会执行\n   // useEffect(() => {\n"
                },
                {
                    "date": 1666144054316,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -46,9 +46,9 @@\n         console.log(markdown)\n       })\n     })\n     return ()=>{\n-      console.log(instance.action(getMarkdown()))\n+      console.log(instance?.action(getMarkdown()))\n \n     }\n   }, [])\n \n"
                },
                {
                    "date": 1666144087077,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -39,17 +39,18 @@\n     }\n     return () => {}\n   }, [loading, content])\n   useEffect(() => {\n+    let now\n     const instance = getInstance()\n     instance?.action((ctx) => {\n       ctx.get(listenerCtx).markdownUpdated((ctx, markdown) => {\n-        console.log(markdown)\n+        if(!now) now = markdown\n       })\n     })\n-    return ()=>{\n+    return () => {\n+      console.log(now)\n       console.log(instance?.action(getMarkdown()))\n-\n     }\n   }, [])\n \n   // 使用空数组，就算后面更新了也不会执行\n"
                },
                {
                    "date": 1666144112074,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -47,8 +47,9 @@\n         if(!now) now = markdown\n       })\n     })\n     return () => {\n+      console.log('111')\n       console.log(now)\n       console.log(instance?.action(getMarkdown()))\n     }\n   }, [])\n"
                },
                {
                    "date": 1666144121130,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -51,9 +51,9 @@\n       console.log('111')\n       console.log(now)\n       console.log(instance?.action(getMarkdown()))\n     }\n-  }, [])\n+  }, [content])\n \n   // 使用空数组，就算后面更新了也不会执行\n   // useEffect(() => {\n   //     const instance = getInstance()\n"
                },
                {
                    "date": 1666144154254,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -46,14 +46,9 @@\n       ctx.get(listenerCtx).markdownUpdated((ctx, markdown) => {\n         if(!now) now = markdown\n       })\n     })\n-    return () => {\n-      console.log('111')\n-      console.log(now)\n-      console.log(instance?.action(getMarkdown()))\n-    }\n-  }, [content])\n+  }, [])\n \n   // 使用空数组，就算后面更新了也不会执行\n   // useEffect(() => {\n   //     const instance = getInstance()\n"
                },
                {
                    "date": 1666144182527,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -39,13 +39,12 @@\n     }\n     return () => {}\n   }, [loading, content])\n   useEffect(() => {\n-    let now\n     const instance = getInstance()\n     instance?.action((ctx) => {\n       ctx.get(listenerCtx).markdownUpdated((ctx, markdown) => {\n-        if(!now) now = markdown\n+        console.log(markdown)\n       })\n     })\n   }, [])\n \n"
                },
                {
                    "date": 1666144270427,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -45,8 +45,11 @@\n       ctx.get(listenerCtx).markdownUpdated((ctx, markdown) => {\n         console.log(markdown)\n       })\n     })\n+    return ()=>{\n+      console.log('组件销毁 了')\n+    }\n   }, [])\n \n   // 使用空数组，就算后面更新了也不会执行\n   // useEffect(() => {\n"
                },
                {
                    "date": 1666144427862,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -32,11 +32,9 @@\n     if (!loading) {\n       const instance = getInstance()\n       instance?.action(replaceAll(content))\n       useUpdateHeaders()\n-      instance?.action((ctx) => {\n-        ctx.get(themeManagerCtx).switch(ctx, nordDark)\n-      })\n+\n     }\n     return () => {}\n   }, [loading, content])\n   useEffect(() => {\n@@ -45,8 +43,11 @@\n       ctx.get(listenerCtx).markdownUpdated((ctx, markdown) => {\n         console.log(markdown)\n       })\n     })\n+    instance?.action((ctx) => {\n+      ctx.get(themeManagerCtx).switch(ctx, nordDark)\n+    })\n     return ()=>{\n       console.log('组件销毁 了')\n     }\n   }, [])\n"
                },
                {
                    "date": 1666144953154,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -40,18 +40,22 @@\n   useEffect(() => {\n     const instance = getInstance()\n     instance?.action((ctx) => {\n       ctx.get(listenerCtx).markdownUpdated((ctx, markdown) => {\n-        console.log(markdown)\n+        console.log('markdownUpdated')\n+        window.api.updateFile({\n+          filePath,\n+          newFileContent:markdown\n+        })\n       })\n     })\n     instance?.action((ctx) => {\n       ctx.get(themeManagerCtx).switch(ctx, nordDark)\n     })\n     return ()=>{\n       console.log('组件销毁 了')\n     }\n-  }, [])\n+  }, [filePath])\n \n   // 使用空数组，就算后面更新了也不会执行\n   // useEffect(() => {\n   //     const instance = getInstance()\n"
                },
                {
                    "date": 1666144981652,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -40,9 +40,9 @@\n   useEffect(() => {\n     const instance = getInstance()\n     instance?.action((ctx) => {\n       ctx.get(listenerCtx).markdownUpdated((ctx, markdown) => {\n-        console.log('markdownUpdated')\n+        console.log(markdown)\n         window.api.updateFile({\n           filePath,\n           newFileContent:markdown\n         })\n@@ -50,11 +50,8 @@\n     })\n     instance?.action((ctx) => {\n       ctx.get(themeManagerCtx).switch(ctx, nordDark)\n     })\n-    return ()=>{\n-      console.log('组件销毁 了')\n-    }\n   }, [filePath])\n \n   // 使用空数组，就算后面更新了也不会执行\n   // useEffect(() => {\n"
                },
                {
                    "date": 1666145006512,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -50,9 +50,9 @@\n     })\n     instance?.action((ctx) => {\n       ctx.get(themeManagerCtx).switch(ctx, nordDark)\n     })\n-  }, [filePath])\n+  }, [])\n \n   // 使用空数组，就算后面更新了也不会执行\n   // useEffect(() => {\n   //     const instance = getInstance()\n"
                },
                {
                    "date": 1666145072740,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -15,9 +15,8 @@\n   filePath: string\n }\n \n export const MilkdownEditor: React.FC<MilkdownEditor> = ({ content, filePath }) => {\n-  const [m, setM] = useState('')\n   // 组件更新时，useEditor不会被重新调用，可能是用了类似useCallback\n   const { editor, loading, getInstance } = useEditor((root) => {\n     const newEditor = Editor.make()\n     useConfig(newEditor, root)\n"
                },
                {
                    "date": 1666145151434,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -39,9 +39,9 @@\n   useEffect(() => {\n     const instance = getInstance()\n     instance?.action((ctx) => {\n       ctx.get(listenerCtx).markdownUpdated((ctx, markdown) => {\n-        console.log(markdown)\n+        console.log(filePath)\n         window.api.updateFile({\n           filePath,\n           newFileContent:markdown\n         })\n"
                },
                {
                    "date": 1666145164999,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -23,12 +23,8 @@\n     usePlugins(newEditor)\n     return newEditor\n   })\n   useEffect(() => {\n-    console.log(filePath)\n-    return () => {}\n-  }, [filePath])\n-  useEffect(() => {\n     if (!loading) {\n       const instance = getInstance()\n       instance?.action(replaceAll(content))\n       useUpdateHeaders()\n"
                },
                {
                    "date": 1666145219971,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -22,8 +22,9 @@\n     useConfig(newEditor, root)\n     usePlugins(newEditor)\n     return newEditor\n   })\n+  const [file,setFile] = useState('')\n   useEffect(() => {\n     if (!loading) {\n       const instance = getInstance()\n       instance?.action(replaceAll(content))\n@@ -35,9 +36,9 @@\n   useEffect(() => {\n     const instance = getInstance()\n     instance?.action((ctx) => {\n       ctx.get(listenerCtx).markdownUpdated((ctx, markdown) => {\n-        console.log(filePath)\n+        console.log(file)\n         window.api.updateFile({\n           filePath,\n           newFileContent:markdown\n         })\n"
                },
                {
                    "date": 1666145233677,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -22,10 +22,11 @@\n     useConfig(newEditor, root)\n     usePlugins(newEditor)\n     return newEditor\n   })\n-  const [file,setFile] = useState('')\n+  const [file,setFile] = useState(0)\n   useEffect(() => {\n+    setFile(Math.random())\n     if (!loading) {\n       const instance = getInstance()\n       instance?.action(replaceAll(content))\n       useUpdateHeaders()\n"
                },
                {
                    "date": 1666145311700,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -47,9 +47,9 @@\n     })\n     instance?.action((ctx) => {\n       ctx.get(themeManagerCtx).switch(ctx, nordDark)\n     })\n-  }, [])\n+  }, [filePath])\n \n   // 使用空数组，就算后面更新了也不会执行\n   // useEffect(() => {\n   //     const instance = getInstance()\n"
                },
                {
                    "date": 1666145346214,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -37,13 +37,13 @@\n   useEffect(() => {\n     const instance = getInstance()\n     instance?.action((ctx) => {\n       ctx.get(listenerCtx).markdownUpdated((ctx, markdown) => {\n-        console.log(file)\n-        window.api.updateFile({\n-          filePath,\n-          newFileContent:markdown\n-        })\n+        console.log(markdown)\n+        // window.api.updateFile({\n+        //   filePath,\n+        //   newFileContent:markdown\n+        // })\n       })\n     })\n     instance?.action((ctx) => {\n       ctx.get(themeManagerCtx).switch(ctx, nordDark)\n"
                },
                {
                    "date": 1666145456018,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -47,8 +47,15 @@\n     })\n     instance?.action((ctx) => {\n       ctx.get(themeManagerCtx).switch(ctx, nordDark)\n     })\n+    return () =>{\n+      instance?.action((ctx) => {\n+        ctx.get(listenerCtx).markdownUpdated(()=>{\n+\n+        })\n+      })\n+    }\n   }, [filePath])\n \n   // 使用空数组，就算后面更新了也不会执行\n   // useEffect(() => {\n"
                },
                {
                    "date": 1666145487518,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -49,11 +49,9 @@\n       ctx.get(themeManagerCtx).switch(ctx, nordDark)\n     })\n     return () =>{\n       instance?.action((ctx) => {\n-        ctx.get(listenerCtx).markdownUpdated(()=>{\n-\n-        })\n+        ctx.get(listenerCtx).markdownUpdated=null\n       })\n     }\n   }, [filePath])\n \n"
                },
                {
                    "date": 1666145521367,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -47,13 +47,8 @@\n     })\n     instance?.action((ctx) => {\n       ctx.get(themeManagerCtx).switch(ctx, nordDark)\n     })\n-    return () =>{\n-      instance?.action((ctx) => {\n-        ctx.get(listenerCtx).markdownUpdated=null\n-      })\n-    }\n   }, [filePath])\n \n   // 使用空数组，就算后面更新了也不会执行\n   // useEffect(() => {\n"
                },
                {
                    "date": 1666145717338,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -22,9 +22,8 @@\n     useConfig(newEditor, root)\n     usePlugins(newEditor)\n     return newEditor\n   })\n-  const [file,setFile] = useState(0)\n   useEffect(() => {\n     setFile(Math.random())\n     if (!loading) {\n       const instance = getInstance()\n@@ -47,9 +46,9 @@\n     })\n     instance?.action((ctx) => {\n       ctx.get(themeManagerCtx).switch(ctx, nordDark)\n     })\n-  }, [filePath])\n+  }, [])\n \n   // 使用空数组，就算后面更新了也不会执行\n   // useEffect(() => {\n   //     const instance = getInstance()\n"
                },
                {
                    "date": 1666145725138,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -23,14 +23,12 @@\n     usePlugins(newEditor)\n     return newEditor\n   })\n   useEffect(() => {\n-    setFile(Math.random())\n     if (!loading) {\n       const instance = getInstance()\n       instance?.action(replaceAll(content))\n       useUpdateHeaders()\n-\n     }\n     return () => {}\n   }, [loading, content])\n   useEffect(() => {\n"
                },
                {
                    "date": 1666146783393,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -26,16 +26,21 @@\n   useEffect(() => {\n     if (!loading) {\n       const instance = getInstance()\n       instance?.action(replaceAll(content))\n+      instance?.action(remove())\n       useUpdateHeaders()\n     }\n-    return () => {}\n+    return () => {\n+    const instance = getInstance()\n+instance?.action(remove)\n+    }\n   }, [loading, content])\n   useEffect(() => {\n     const instance = getInstance()\n     instance?.action((ctx) => {\n       ctx.get(listenerCtx).markdownUpdated((ctx, markdown) => {\n+      \n         console.log(markdown)\n         // window.api.updateFile({\n         //   filePath,\n         //   newFileContent:markdown\n"
                },
                {
                    "date": 1666146879786,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -26,14 +26,12 @@\n   useEffect(() => {\n     if (!loading) {\n       const instance = getInstance()\n       instance?.action(replaceAll(content))\n-      instance?.action(remove())\n       useUpdateHeaders()\n     }\n     return () => {\n     const instance = getInstance()\n-instance?.action(remove)\n     }\n   }, [loading, content])\n   useEffect(() => {\n     const instance = getInstance()\n"
                },
                {
                    "date": 1666147046158,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -36,9 +36,8 @@\n   useEffect(() => {\n     const instance = getInstance()\n     instance?.action((ctx) => {\n       ctx.get(listenerCtx).markdownUpdated((ctx, markdown) => {\n-      \n         console.log(markdown)\n         // window.api.updateFile({\n         //   filePath,\n         //   newFileContent:markdown\n@@ -48,17 +47,6 @@\n     instance?.action((ctx) => {\n       ctx.get(themeManagerCtx).switch(ctx, nordDark)\n     })\n   }, [])\n-\n-  // 使用空数组，就算后面更新了也不会执行\n-  // useEffect(() => {\n-  //     const instance = getInstance()\n-  //     instance?.action((ctx) => {\n-  //       ctx.get(listenerCtx).markdownUpdated((ctx,markdown,preMarkdown) =>{\n-  //         console.log('changexxxxx')\n-  //       })\n-  //     })\n-\n-  // },[loading])\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1666147116182,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -29,20 +29,25 @@\n       instance?.action(replaceAll(content))\n       useUpdateHeaders()\n     }\n     return () => {\n-    const instance = getInstance()\n+      const instance = getInstance()\n     }\n   }, [loading, content])\n+  const update = (markdown: string) => {\n+    console.log('xxxxxxx')\n+    console.log(markdown)\n+    window.api.updateFile({\n+      filePath,\n+      newFileContent: markdown\n+    })\n+  }\n   useEffect(() => {\n     const instance = getInstance()\n     instance?.action((ctx) => {\n       ctx.get(listenerCtx).markdownUpdated((ctx, markdown) => {\n         console.log(markdown)\n-        // window.api.updateFile({\n-        //   filePath,\n-        //   newFileContent:markdown\n-        // })\n+        update(markdown)\n       })\n     })\n     instance?.action((ctx) => {\n       ctx.get(themeManagerCtx).switch(ctx, nordDark)\n"
                },
                {
                    "date": 1666147122866,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -34,9 +34,9 @@\n     }\n   }, [loading, content])\n   const update = (markdown: string) => {\n     console.log('xxxxxxx')\n-    console.log(markdown)\n+    console.log(filePath)\n     window.api.updateFile({\n       filePath,\n       newFileContent: markdown\n     })\n@@ -44,9 +44,8 @@\n   useEffect(() => {\n     const instance = getInstance()\n     instance?.action((ctx) => {\n       ctx.get(listenerCtx).markdownUpdated((ctx, markdown) => {\n-        console.log(markdown)\n         update(markdown)\n       })\n     })\n     instance?.action((ctx) => {\n"
                },
                {
                    "date": 1666147273784,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -32,8 +32,9 @@\n     return () => {\n       const instance = getInstance()\n     }\n   }, [loading, content])\n+  console.log('gggggggg')\n   const update = (markdown: string) => {\n     console.log('xxxxxxx')\n     console.log(filePath)\n     window.api.updateFile({\n"
                },
                {
                    "date": 1666147379224,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -12,11 +12,12 @@\n \n interface MilkdownEditor {\n   content: string\n   filePath: string\n+  update:Function\n }\n \n-export const MilkdownEditor: React.FC<MilkdownEditor> = ({ content, filePath }) => {\n+export const MilkdownEditor: React.FC<MilkdownEditor> = ({ content, filePath,update }) => {\n   // 组件更新时，useEditor不会被重新调用，可能是用了类似useCallback\n   const { editor, loading, getInstance } = useEditor((root) => {\n     const newEditor = Editor.make()\n     useConfig(newEditor, root)\n@@ -33,16 +34,9 @@\n       const instance = getInstance()\n     }\n   }, [loading, content])\n   console.log('gggggggg')\n-  const update = (markdown: string) => {\n-    console.log('xxxxxxx')\n-    console.log(filePath)\n-    window.api.updateFile({\n-      filePath,\n-      newFileContent: markdown\n-    })\n-  }\n+\n   useEffect(() => {\n     const instance = getInstance()\n     instance?.action((ctx) => {\n       ctx.get(listenerCtx).markdownUpdated((ctx, markdown) => {\n"
                },
                {
                    "date": 1666149277047,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -29,13 +29,9 @@\n       const instance = getInstance()\n       instance?.action(replaceAll(content))\n       useUpdateHeaders()\n     }\n-    return () => {\n-      const instance = getInstance()\n-    }\n   }, [loading, content])\n-  console.log('gggggggg')\n \n   useEffect(() => {\n     const instance = getInstance()\n     instance?.action((ctx) => {\n"
                },
                {
                    "date": 1666149485504,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -35,9 +35,10 @@\n   useEffect(() => {\n     const instance = getInstance()\n     instance?.action((ctx) => {\n       ctx.get(listenerCtx).markdownUpdated((ctx, markdown) => {\n-        update(markdown)\n+        console.log(filePath)\n+        // update(markdown)\n       })\n     })\n     instance?.action((ctx) => {\n       ctx.get(themeManagerCtx).switch(ctx, nordDark)\n"
                },
                {
                    "date": 1666149628848,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -12,12 +12,11 @@\n \n interface MilkdownEditor {\n   content: string\n   filePath: string\n-  update:Function\n }\n \n-export const MilkdownEditor: React.FC<MilkdownEditor> = ({ content, filePath,update }) => {\n+export const MilkdownEditor: React.FC<MilkdownEditor> = ({ content, filePath }) => {\n   // 组件更新时，useEditor不会被重新调用，可能是用了类似useCallback\n   const { editor, loading, getInstance } = useEditor((root) => {\n     const newEditor = Editor.make()\n     useConfig(newEditor, root)\n@@ -35,10 +34,8 @@\n   useEffect(() => {\n     const instance = getInstance()\n     instance?.action((ctx) => {\n       ctx.get(listenerCtx).markdownUpdated((ctx, markdown) => {\n-        console.log(filePath)\n-        // update(markdown)\n       })\n     })\n     instance?.action((ctx) => {\n       ctx.get(themeManagerCtx).switch(ctx, nordDark)\n"
                },
                {
                    "date": 1666149772106,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -15,9 +15,14 @@\n   filePath: string\n }\n \n export const MilkdownEditor: React.FC<MilkdownEditor> = ({ content, filePath }) => {\n-  // 组件更新时，useEditor不会被重新调用，可能是用了类似useCallback\n+  useEffect(() => {\n+    window.api.updateFile({\n+      filePath:filePath,\n+      newFileContent: ''\n+    })\n+  }, [filePath])\n   const { editor, loading, getInstance } = useEditor((root) => {\n     const newEditor = Editor.make()\n     useConfig(newEditor, root)\n     usePlugins(newEditor)\n"
                },
                {
                    "date": 1666149796300,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -15,8 +15,9 @@\n   filePath: string\n }\n \n export const MilkdownEditor: React.FC<MilkdownEditor> = ({ content, filePath }) => {\n+  const [markdown,setMarkdown] = useState('')\n   useEffect(() => {\n     window.api.updateFile({\n       filePath:filePath,\n       newFileContent: ''\n"
                },
                {
                    "date": 1666149816721,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -21,9 +21,9 @@\n     window.api.updateFile({\n       filePath:filePath,\n       newFileContent: ''\n     })\n-  }, [filePath])\n+  }, [markdown])\n   const { editor, loading, getInstance } = useEditor((root) => {\n     const newEditor = Editor.make()\n     useConfig(newEditor, root)\n     usePlugins(newEditor)\n@@ -40,8 +40,9 @@\n   useEffect(() => {\n     const instance = getInstance()\n     instance?.action((ctx) => {\n       ctx.get(listenerCtx).markdownUpdated((ctx, markdown) => {\n+        setMarkdown(markdown)\n       })\n     })\n     instance?.action((ctx) => {\n       ctx.get(themeManagerCtx).switch(ctx, nordDark)\n"
                },
                {
                    "date": 1666149823851,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -17,11 +17,12 @@\n \n export const MilkdownEditor: React.FC<MilkdownEditor> = ({ content, filePath }) => {\n   const [markdown,setMarkdown] = useState('')\n   useEffect(() => {\n+    console.log(filePath)\n     window.api.updateFile({\n       filePath:filePath,\n-      newFileContent: ''\n+      newFileContent: markdown\n     })\n   }, [markdown])\n   const { editor, loading, getInstance } = useEditor((root) => {\n     const newEditor = Editor.make()\n"
                },
                {
                    "date": 1666149845516,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -22,9 +22,9 @@\n     window.api.updateFile({\n       filePath:filePath,\n       newFileContent: markdown\n     })\n-  }, [markdown])\n+  }, [filePath])\n   const { editor, loading, getInstance } = useEditor((root) => {\n     const newEditor = Editor.make()\n     useConfig(newEditor, root)\n     usePlugins(newEditor)\n"
                },
                {
                    "date": 1666149969549,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -22,9 +22,9 @@\n     window.api.updateFile({\n       filePath:filePath,\n       newFileContent: markdown\n     })\n-  }, [filePath])\n+  }, [filePath,markdown])\n   const { editor, loading, getInstance } = useEditor((root) => {\n     const newEditor = Editor.make()\n     useConfig(newEditor, root)\n     usePlugins(newEditor)\n"
                },
                {
                    "date": 1666150099456,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -17,9 +17,8 @@\n \n export const MilkdownEditor: React.FC<MilkdownEditor> = ({ content, filePath }) => {\n   const [markdown,setMarkdown] = useState('')\n   useEffect(() => {\n-    console.log(filePath)\n     window.api.updateFile({\n       filePath:filePath,\n       newFileContent: markdown\n     })\n"
                },
                {
                    "date": 1666150403509,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -21,9 +21,9 @@\n     window.api.updateFile({\n       filePath:filePath,\n       newFileContent: markdown\n     })\n-  }, [filePath,markdown])\n+  }, [markdown])\n   const { editor, loading, getInstance } = useEditor((root) => {\n     const newEditor = Editor.make()\n     useConfig(newEditor, root)\n     usePlugins(newEditor)\n@@ -34,9 +34,9 @@\n       const instance = getInstance()\n       instance?.action(replaceAll(content))\n       useUpdateHeaders()\n     }\n-  }, [loading, content])\n+  }, [loading, filePath])\n \n   useEffect(() => {\n     const instance = getInstance()\n     instance?.action((ctx) => {\n"
                },
                {
                    "date": 1666150743825,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -34,9 +34,9 @@\n       const instance = getInstance()\n       instance?.action(replaceAll(content))\n       useUpdateHeaders()\n     }\n-  }, [loading, filePath])\n+  }, [loading, content])\n \n   useEffect(() => {\n     const instance = getInstance()\n     instance?.action((ctx) => {\n"
                },
                {
                    "date": 1666150803565,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -16,14 +16,8 @@\n }\n \n export const MilkdownEditor: React.FC<MilkdownEditor> = ({ content, filePath }) => {\n   const [markdown,setMarkdown] = useState('')\n-  useEffect(() => {\n-    window.api.updateFile({\n-      filePath:filePath,\n-      newFileContent: markdown\n-    })\n-  }, [markdown])\n   const { editor, loading, getInstance } = useEditor((root) => {\n     const newEditor = Editor.make()\n     useConfig(newEditor, root)\n     usePlugins(newEditor)\n@@ -35,9 +29,17 @@\n       instance?.action(replaceAll(content))\n       useUpdateHeaders()\n     }\n   }, [loading, content])\n+  useEffect(() => {\n+    window.api.updateFile({\n+      filePath:filePath,\n+      newFileContent: markdown\n+    })\n+  }, [markdown])\n \n+\n+\n   useEffect(() => {\n     const instance = getInstance()\n     instance?.action((ctx) => {\n       ctx.get(listenerCtx).markdownUpdated((ctx, markdown) => {\n"
                },
                {
                    "date": 1666150967271,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -16,8 +16,9 @@\n }\n \n export const MilkdownEditor: React.FC<MilkdownEditor> = ({ content, filePath }) => {\n   const [markdown,setMarkdown] = useState('')\n+  const [isOpend,setOpend] = useState(false)\n   const { editor, loading, getInstance } = useEditor((root) => {\n     const newEditor = Editor.make()\n     useConfig(newEditor, root)\n     usePlugins(newEditor)\n@@ -26,16 +27,19 @@\n   useEffect(() => {\n     if (!loading) {\n       const instance = getInstance()\n       instance?.action(replaceAll(content))\n+      setOpend(true)\n       useUpdateHeaders()\n     }\n   }, [loading, content])\n   useEffect(() => {\n-    window.api.updateFile({\n-      filePath:filePath,\n-      newFileContent: markdown\n-    })\n+    if(isOpend) {\n+      window.api.updateFile({\n+        filePath:filePath,\n+        newFileContent: markdown\n+      })\n+    }\n   }, [markdown])\n \n \n \n"
                },
                {
                    "date": 1666150982125,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -15,10 +15,10 @@\n   filePath: string\n }\n \n export const MilkdownEditor: React.FC<MilkdownEditor> = ({ content, filePath }) => {\n-  const [markdown,setMarkdown] = useState('')\n-  const [isOpend,setOpend] = useState(false)\n+  const [markdown, setMarkdown] = useState('')\n+  const [isOpend, setOpend] = useState(false)\n   const { editor, loading, getInstance } = useEditor((root) => {\n     const newEditor = Editor.make()\n     useConfig(newEditor, root)\n     usePlugins(newEditor)\n@@ -32,18 +32,16 @@\n       useUpdateHeaders()\n     }\n   }, [loading, content])\n   useEffect(() => {\n-    if(isOpend) {\n+    if (isOpend) {\n       window.api.updateFile({\n-        filePath:filePath,\n+        filePath: filePath,\n         newFileContent: markdown\n       })\n     }\n   }, [markdown])\n \n-\n-\n   useEffect(() => {\n     const instance = getInstance()\n     instance?.action((ctx) => {\n       ctx.get(listenerCtx).markdownUpdated((ctx, markdown) => {\n"
                },
                {
                    "date": 1666151024228,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -27,10 +27,11 @@\n   useEffect(() => {\n     if (!loading) {\n       const instance = getInstance()\n       instance?.action(replaceAll(content))\n+      useUpdateHeaders()\n       setOpend(true)\n-      useUpdateHeaders()\n+\n     }\n   }, [loading, content])\n   useEffect(() => {\n     if (isOpend) {\n"
                },
                {
                    "date": 1666151084864,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -16,9 +16,8 @@\n }\n \n export const MilkdownEditor: React.FC<MilkdownEditor> = ({ content, filePath }) => {\n   const [markdown, setMarkdown] = useState('')\n-  const [isOpend, setOpend] = useState(false)\n   const { editor, loading, getInstance } = useEditor((root) => {\n     const newEditor = Editor.make()\n     useConfig(newEditor, root)\n     usePlugins(newEditor)\n@@ -28,19 +27,15 @@\n     if (!loading) {\n       const instance = getInstance()\n       instance?.action(replaceAll(content))\n       useUpdateHeaders()\n-      setOpend(true)\n-\n     }\n   }, [loading, content])\n   useEffect(() => {\n-    if (isOpend) {\n-      window.api.updateFile({\n-        filePath: filePath,\n-        newFileContent: markdown\n-      })\n-    }\n+    window.api.updateFile({\n+      filePath: filePath,\n+      newFileContent: markdown\n+    })\n   }, [markdown])\n \n   useEffect(() => {\n     const instance = getInstance()\n"
                },
                {
                    "date": 1666152178800,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -22,15 +22,18 @@\n     useConfig(newEditor, root)\n     usePlugins(newEditor)\n     return newEditor\n   })\n+  // 全部替换，点击文件列表的时候起作用\n   useEffect(() => {\n     if (!loading) {\n       const instance = getInstance()\n       instance?.action(replaceAll(content))\n+      // 更新完成后再渲染标题\n       useUpdateHeaders()\n     }\n   }, [loading, content])\n+  // 存储的函数必须根据副作用实时修改，否则不会更新\n   useEffect(() => {\n     window.api.updateFile({\n       filePath: filePath,\n       newFileContent: markdown\n"
                },
                {
                    "date": 1666156035903,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,11 +1,11 @@\n import React, { useEffect, useState } from 'react'\n-import { Editor, editorStateCtx } from '@milkdown/core'\n+import { Editor} from '@milkdown/core'\n \n import { ReactEditor, useEditor } from '@milkdown/react'\n import { usePlugins } from './hooks/usePlugins'\n import { themeManagerCtx } from '@milkdown/core'\n-import { replaceAll, getMarkdown } from '@milkdown/utils'\n+import { replaceAll } from '@milkdown/utils'\n import { nordDark } from '@milkdown/theme-nord'\n import { useConfig } from './hooks/useConfig'\n import { useUpdateHeaders } from '../SideBar/hooks/useUpdateHeader'\n import { listenerCtx } from '@milkdown/plugin-listener'\n"
                },
                {
                    "date": 1666164607577,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,6 +1,6 @@\n import React, { useEffect, useState } from 'react'\n-import { Editor} from '@milkdown/core'\n+import { Editor } from '@milkdown/core'\n \n import { ReactEditor, useEditor } from '@milkdown/react'\n import { usePlugins } from './hooks/usePlugins'\n import { themeManagerCtx } from '@milkdown/core'\n@@ -47,9 +47,9 @@\n         setMarkdown(markdown)\n       })\n     })\n     instance?.action((ctx) => {\n-      ctx.get(themeManagerCtx).switch(ctx, nordDark)\n+      // ctx.get(themeManagerCtx).switch(ctx, nordDark)\n     })\n   }, [])\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1666167630565,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -47,9 +47,9 @@\n         setMarkdown(markdown)\n       })\n     })\n     instance?.action((ctx) => {\n-      // ctx.get(themeManagerCtx).switch(ctx, nordDark)\n+      ctx.get(themeManagerCtx).switch(ctx, nordDark)\n     })\n   }, [])\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1666193330370,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -47,9 +47,9 @@\n         setMarkdown(markdown)\n       })\n     })\n     instance?.action((ctx) => {\n-      ctx.get(themeManagerCtx).switch(ctx, nordDark)\n+      // ctx.get(themeManagerCtx).switch(ctx, nordDark)\n     })\n   }, [])\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1666193485318,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -47,9 +47,9 @@\n         setMarkdown(markdown)\n       })\n     })\n     instance?.action((ctx) => {\n-      // ctx.get(themeManagerCtx).switch(ctx, nordDark)\n+      ctx.get(themeManagerCtx).switch(ctx, nordDark)\n     })\n   }, [])\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1666193571528,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -47,9 +47,9 @@\n         setMarkdown(markdown)\n       })\n     })\n     instance?.action((ctx) => {\n-      ctx.get(themeManagerCtx).switch(ctx, nordDark)\n+      // ctx.get(themeManagerCtx).switch(ctx, nordDark)\n     })\n   }, [])\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1666193602328,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -46,9 +46,9 @@\n       ctx.get(listenerCtx).markdownUpdated((ctx, markdown) => {\n         setMarkdown(markdown)\n       })\n     })\n-    instance?.action((ctx) => {\n+    instance!.action((ctx) => {\n       // ctx.get(themeManagerCtx).switch(ctx, nordDark)\n     })\n   }, [])\n   return <ReactEditor editor={editor} />\n"
                },
                {
                    "date": 1666193639612,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -43,13 +43,14 @@\n   useEffect(() => {\n     const instance = getInstance()\n     instance?.action((ctx) => {\n       ctx.get(listenerCtx).markdownUpdated((ctx, markdown) => {\n+        console.log('markdownUpdated')\n         setMarkdown(markdown)\n       })\n     })\n     instance!.action((ctx) => {\n-      // ctx.get(themeManagerCtx).switch(ctx, nordDark)\n+      ctx.get(themeManagerCtx).switch(ctx, nordDark)\n     })\n   }, [])\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1666332753484,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -47,9 +47,9 @@\n         console.log('markdownUpdated')\n         setMarkdown(markdown)\n       })\n     })\n-    instance!.action((ctx) => {\n+    instance?.action((ctx) => {\n       ctx.get(themeManagerCtx).switch(ctx, nordDark)\n     })\n   }, [])\n   return <ReactEditor editor={editor} />\n"
                },
                {
                    "date": 1666332814722,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -46,11 +46,10 @@\n       ctx.get(listenerCtx).markdownUpdated((ctx, markdown) => {\n         console.log('markdownUpdated')\n         setMarkdown(markdown)\n       })\n-    })\n-    instance?.action((ctx) => {\n       ctx.get(themeManagerCtx).switch(ctx, nordDark)\n+\n     })\n   }, [])\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1666333174574,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -46,9 +46,8 @@\n       ctx.get(listenerCtx).markdownUpdated((ctx, markdown) => {\n         console.log('markdownUpdated')\n         setMarkdown(markdown)\n       })\n-      ctx.get(themeManagerCtx).switch(ctx, nordDark)\n \n     })\n   }, [])\n   return <ReactEditor editor={editor} />\n"
                },
                {
                    "date": 1666333196339,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,11 +2,9 @@\n import { Editor } from '@milkdown/core'\n \n import { ReactEditor, useEditor } from '@milkdown/react'\n import { usePlugins } from './hooks/usePlugins'\n-import { themeManagerCtx } from '@milkdown/core'\n import { replaceAll } from '@milkdown/utils'\n-import { nordDark } from '@milkdown/theme-nord'\n import { useConfig } from './hooks/useConfig'\n import { useUpdateHeaders } from '../SideBar/hooks/useUpdateHeader'\n import { listenerCtx } from '@milkdown/plugin-listener'\n \n@@ -46,9 +44,8 @@\n       ctx.get(listenerCtx).markdownUpdated((ctx, markdown) => {\n         console.log('markdownUpdated')\n         setMarkdown(markdown)\n       })\n-\n     })\n   }, [])\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1666637954203,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -13,12 +13,13 @@\n   filePath: string\n }\n \n export const MilkdownEditor: React.FC<MilkdownEditor> = ({ content, filePath }) => {\n+  console.log('MilkdownEditor-render')\n   const [markdown, setMarkdown] = useState('')\n   const { editor, loading, getInstance } = useEditor((root) => {\n     const newEditor = Editor.make()\n-    useConfig(newEditor, root)\n+    useConfig(newEditor, root, setMarkdown)\n     usePlugins(newEditor)\n     return newEditor\n   })\n   // 全部替换，点击文件列表的时候起作用\n@@ -36,16 +37,6 @@\n       filePath: filePath,\n       newFileContent: markdown\n     })\n   }, [markdown])\n-\n-  useEffect(() => {\n-    const instance = getInstance()\n-    instance?.action((ctx) => {\n-      ctx.get(listenerCtx).markdownUpdated((ctx, markdown) => {\n-        console.log('markdownUpdated')\n-        setMarkdown(markdown)\n-      })\n-    })\n-  }, [])\n   return <ReactEditor editor={editor} />\n }\n"
                },
                {
                    "date": 1666637966174,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,9 +5,8 @@\n import { usePlugins } from './hooks/usePlugins'\n import { replaceAll } from '@milkdown/utils'\n import { useConfig } from './hooks/useConfig'\n import { useUpdateHeaders } from '../SideBar/hooks/useUpdateHeader'\n-import { listenerCtx } from '@milkdown/plugin-listener'\n \n interface MilkdownEditor {\n   content: string\n   filePath: string\n"
                },
                {
                    "date": 1666688905616,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,8 +5,9 @@\n import { usePlugins } from './hooks/usePlugins'\n import { replaceAll } from '@milkdown/utils'\n import { useConfig } from './hooks/useConfig'\n import { useUpdateHeaders } from '../SideBar/hooks/useUpdateHeader'\n+import { SAVE_FILE } from '../../../../main/electron/events/constant'\n \n interface MilkdownEditor {\n   content: string\n   filePath: string\n@@ -31,9 +32,9 @@\n     }\n   }, [loading, content])\n   // 存储的函数必须根据副作用实时修改，否则不会更新\n   useEffect(() => {\n-    window.api.updateFile({\n+    window.api.sendEvents(SAVE_FILE,{\n       filePath: filePath,\n       newFileContent: markdown\n     })\n   }, [markdown])\n"
                },
                {
                    "date": 1667191487870,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,8 +1,8 @@\n import React, { useEffect, useState } from 'react'\n import { Editor } from '@milkdown/core'\n \n-import { ReactEditor, useEditor } from '@milkdown/react'\n+import { ReactEditor, useEditor } from '@milkdown/react';\n import { usePlugins } from './hooks/usePlugins'\n import { replaceAll } from '@milkdown/utils'\n import { useConfig } from './hooks/useConfig'\n import { useUpdateHeaders } from '../SideBar/hooks/useUpdateHeader'\n@@ -12,10 +12,10 @@\n   content: string\n   filePath: string\n }\n \n-export const MilkdownEditor: React.FC<MilkdownEditor> = ({ content, filePath }) => {\n-  console.log('MilkdownEditor-render')\n+export const MilkdownEditor:React.FC<MilkdownEditor> = ({ content, filePath }) => {\n+    console.log('MilkdownEditor-render')\n   const [markdown, setMarkdown] = useState('')\n   const { editor, loading, getInstance } = useEditor((root) => {\n     const newEditor = Editor.make()\n     useConfig(newEditor, root, setMarkdown)\n@@ -37,6 +37,6 @@\n       filePath: filePath,\n       newFileContent: markdown\n     })\n   }, [markdown])\n-  return <ReactEditor editor={editor} />\n+  return <ReactEditor editor={editor}/>\n }\n"
                },
                {
                    "date": 1667210968945,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,8 +1,8 @@\n import React, { useEffect, useState } from 'react'\n import { Editor } from '@milkdown/core'\n \n-import { ReactEditor, useEditor } from '@milkdown/react';\n+import { ReactEditor, useEditor } from '@milkdown/react'\n import { usePlugins } from './hooks/usePlugins'\n import { replaceAll } from '@milkdown/utils'\n import { useConfig } from './hooks/useConfig'\n import { useUpdateHeaders } from '../SideBar/hooks/useUpdateHeader'\n@@ -12,10 +12,10 @@\n   content: string\n   filePath: string\n }\n \n-export const MilkdownEditor:React.FC<MilkdownEditor> = ({ content, filePath }) => {\n-    console.log('MilkdownEditor-render')\n+export const MilkdownEditor: React.FC<MilkdownEditor> = ({ content, filePath }) => {\n+  console.log('MilkdownEditor-render')\n   const [markdown, setMarkdown] = useState('')\n   const { editor, loading, getInstance } = useEditor((root) => {\n     const newEditor = Editor.make()\n     useConfig(newEditor, root, setMarkdown)\n@@ -32,11 +32,11 @@\n     }\n   }, [loading, content])\n   // 存储的函数必须根据副作用实时修改，否则不会更新\n   useEffect(() => {\n-    window.api.sendEvents(SAVE_FILE,{\n+    window.api.sendEvents(SAVE_FILE, {\n       filePath: filePath,\n       newFileContent: markdown\n     })\n   }, [markdown])\n-  return <ReactEditor editor={editor}/>\n+  return <ReactEditor editor={editor} />\n }\n"
                }
            ],
            "date": 1665496693570,
            "name": "Commit-0",
            "content": "import React, { useEffect, useState } from 'react'\nimport { defaultValueCtx, Editor, rootCtx } from '@milkdown/core'\nimport { nord } from '@milkdown/theme-nord'\nimport { ReactEditor, useEditor } from '@milkdown/react'\n// 通用markdown预设\nimport { commonmark } from '@milkdown/preset-commonmark'\nimport { history } from '@milkdown/plugin-history'\nimport { defaultMarkdown } from '../../constant'\nimport { listenerCtx, listener } from '@milkdown/plugin-listener'\nimport { prism } from '@milkdown/plugin-prism'\nimport { menu } from '@milkdown/plugin-menu'\nimport { themeManagerCtx } from '@milkdown/core'\n// 亮色主题\nimport { nordLight } from '@milkdown/theme-nord'\n// 暗色主题\nimport { nordDark } from '@milkdown/theme-nord'\ninterface MilkdownEditor {\n  onHeadersChange: Function\n}\nexport const MilkdownEditor: React.FC<MilkdownEditor> = ({ onHeadersChange }) => {\n  const [headers, setHeaders] = useState([{}])\n  useEffect(() => {\n    console.log('headers-change')\n    onHeadersChange(headers)\n  }, [headers.length])\n  const { editor, getInstance } = useEditor((root) =>\n    Editor.make()\n      .config((ctx) => {\n        ctx.set(rootCtx, root),\n          ctx.set(defaultValueCtx, defaultMarkdown),\n          // // 代码的默认形式？\n          // ctx.set(defaultValueCtx,{\n          //     type:'html',\n          //     dom:document.querySelector('#pre') as HTMLElement\n          //   })\n          ctx.get(listenerCtx).markdownUpdated((ctx, markdown, prevMarkdown) => {})\n      })\n      .use(nord)\n      .use(commonmark)\n      .use(history)\n      .use(listener)\n      .use(prism)\n      .use(menu)\n  )\n\n  const instance = getInstance()\n  instance?.action((ctx) => {\n    ctx.get(themeManagerCtx).switch(ctx, nordDark)\n  })\n  return <ReactEditor editor={editor} />\n}\n"
        }
    ]
}